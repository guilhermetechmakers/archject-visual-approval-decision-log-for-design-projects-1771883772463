⚠️ CRITICAL EXECUTION RULES - READ FIRST ⚠️
❌ NEVER run: npm run dev, npm start, yarn dev, pnpm dev, or ANY development server
❌ NEVER run: long-running processes, servers, or commands that don't exit
❌ NEVER test the application by starting it
✅ ALLOWED: npm install, npm run build, npm run test (if needed)
✅ YOUR TASK: Create/modify files only, then STOP and EXIT immediately
⚠️ The MCP server handles all testing and validation separately

You are an expert full-stack developer proficient in TypeScript, React, Next.js, and modern UI/UX frameworks (Tailwind CSS, Shadcn UI, Radix UI).

=== DESIGN REFERENCE (MANDATORY) ===
# Modern Design Best Practices

## Philosophy

Create unique, memorable experiences while maintaining consistency through modern design principles. Every project should feel distinct yet professional, innovative yet intuitive.

---

## Landing Pages & Marketing Sites

### Hero Sections
**Go beyond static backgrounds:**
- Animated gradients with subtle movement
- Particle systems or geometric shapes floating
- Interactive canvas backgrounds (Three.js, WebGL)
- Video backgrounds with proper fallbacks
- Parallax scrolling effects
- Gradient mesh animations
- Morphing blob animations


### Layout Patterns
**Use modern grid systems:**
- Bento grids (asymmetric card layouts)
- Masonry layouts for varied content
- Feature sections with diagonal cuts or curves
- Overlapping elements with proper z-index
- Split-screen designs with scroll-triggered reveals

**Avoid:** Traditional 3-column equal grids

### Scroll Animations
**Engage users as they scroll:**
- Fade-in and slide-up animations for sections
- Scroll-triggered parallax effects
- Progress indicators for long pages
- Sticky elements that transform on scroll
- Horizontal scroll sections for portfolios
- Text reveal animations (word by word, letter by letter)
- Number counters animating into view

**Avoid:** Static pages with no scroll interaction

### Call-to-Action Areas
**Make CTAs impossible to miss:**
- Gradient buttons with hover effects
- Floating action buttons with micro-interactions
- Animated borders or glowing effects
- Scale/lift on hover
- Interactive elements that respond to mouse position
- Pulsing indicators for primary actions

---

## Dashboard Applications

### Layout Structure
**Always use collapsible side navigation:**
- Sidebar that can collapse to icons only
- Smooth transition animations between states
- Persistent navigation state (remember user preference)
- Mobile: drawer that slides in/out
- Desktop: sidebar with expand/collapse toggle
- Icons visible even when collapsed

**Structure:**
```
/dashboard (layout wrapper with sidebar)
  /dashboard/overview
  /dashboard/analytics
  /dashboard/settings
  /dashboard/users
  /dashboard/projects
```

All dashboard pages should be nested inside the dashboard layout, not separate routes.

### Data Tables
**Modern table design:**
- Sticky headers on scroll
- Row hover states with subtle elevation
- Sortable columns with clear indicators
- Pagination with items-per-page control
- Search/filter with instant feedback
- Selection checkboxes with bulk actions
- Responsive: cards on mobile, table on desktop
- Loading skeletons, not spinners
- Empty states with illustrations or helpful text

**Use modern table libraries:**
- TanStack Table (React Table v8)
- AG Grid for complex data
- Data Grid from MUI (if using MUI)

### Charts & Visualizations
**Use the latest charting libraries:**
- Recharts (for React, simple charts)
- Chart.js v4 (versatile, well-maintained)
- Apache ECharts (advanced, interactive)
- D3.js (custom, complex visualizations)
- Tremor (for dashboards, built on Recharts)

**Chart best practices:**
- Animated transitions when data changes
- Interactive tooltips with detailed info
- Responsive sizing
- Color scheme matching design system
- Legend placement that doesn't obstruct data
- Loading states while fetching data

### Dashboard Cards
**Metric cards should stand out:**
- Gradient backgrounds or colored accents
- Trend indicators (↑ ↓ with color coding)
- Sparkline charts for historical data
- Hover effects revealing more detail
- Icon representing the metric
- Comparison to previous period

---

## Color & Visual Design

### Color Palettes
**Create depth with gradients:**
- Primary gradient (not just solid primary color)
- Subtle background gradients
- Gradient text for headings
- Gradient borders on cards
- Elevated surfaces for depth

**Color usage:**
- 60-30-10 rule (dominant, secondary, accent)
- Consistent semantic colors (success, warning, error)
- Accessible contrast ratios (WCAG AA minimum)

### Typography
**Create hierarchy through contrast:**
- Large, bold headings (48-72px for heroes)
- Clear size differences between levels
- Variable font weights (300, 400, 600, 700)
- Letter spacing for small caps
- Line height 1.5-1.7 for body text
- Inter, Poppins, or DM Sans for modern feel

### Shadows & Depth
**Layer UI elements:**
- Multi-layer shadows for realistic depth
- Colored shadows matching element color
- Elevated states on hover
- Neumorphism for special elements (sparingly)

---

## Interactions & Micro-animations

### Button Interactions
**Every button should react:**
- Scale slightly on hover (1.02-1.05)
- Lift with shadow on hover
- Ripple effect on click
- Loading state with spinner or progress
- Disabled state clearly visible
- Success state with checkmark animation

### Card Interactions
**Make cards feel alive:**
- Lift on hover with increased shadow
- Subtle border glow on hover
- Tilt effect following mouse (3D transform)
- Smooth transitions (200-300ms)
- Click feedback for interactive cards

### Form Interactions
**Guide users through forms:**
- Input focus states with border color change
- Floating labels that animate up
- Real-time validation with inline messages
- Success checkmarks for valid inputs
- Error states with shake animation
- Password strength indicators
- Character count for text areas

### Page Transitions
**Smooth between views:**
- Fade + slide for page changes
- Skeleton loaders during data fetch
- Optimistic UI updates
- Stagger animations for lists
- Route transition animations

---

## Mobile Responsiveness

### Mobile-First Approach
**Design for mobile, enhance for desktop:**
- Touch targets minimum 44x44px
- Generous padding and spacing
- Sticky bottom navigation on mobile
- Collapsible sections for long content
- Swipeable cards and galleries
- Pull-to-refresh where appropriate

### Responsive Patterns
**Adapt layouts intelligently:**
- Hamburger menu → full nav bar
- Card grid → stack on mobile
- Sidebar → drawer
- Multi-column → single column
- Data tables → card list
- Hide/show elements based on viewport

---

## Loading & Empty States

### Loading States
**Never leave users wondering:**
- Skeleton screens matching content layout
- Progress bars for known durations
- Animated placeholders
- Spinners only for short waits (<3s)
- Stagger loading for multiple elements
- Shimmer effects on skeletons

### Empty States
**Make empty states helpful:**
- Illustrations or icons
- Helpful copy explaining why it's empty
- Clear CTA to add first item
- Examples or suggestions
- No "no data" text alone

---

## Unique Elements to Stand Out

### Distinctive Features
**Add personality:**
- Custom cursor effects on landing pages
- Animated page numbers or section indicators
- Unusual hover effects (magnification, distortion)
- Custom scrollbars
- Glassmorphism for overlays
- Animated SVG icons
- Typewriter effects for hero text
- Confetti or celebration animations for actions

### Interactive Elements
**Engage users:**
- Drag-and-drop interfaces
- Sliders and range controls
- Toggle switches with animations
- Progress steps with animations
- Expandable/collapsible sections
- Tabs with slide indicators
- Image comparison sliders
- Interactive demos or playgrounds

---

## Consistency Rules

### Maintain Consistency
**What should stay consistent:**
- Spacing scale (4px, 8px, 16px, 24px, 32px, 48px, 64px)
- Border radius values
- Animation timing (200ms, 300ms, 500ms)
- Color system (primary, secondary, accent, neutrals)
- Typography scale
- Icon style (outline vs filled)
- Button styles across the app
- Form element styles

### What Can Vary
**Project-specific customization:**
- Color palette (different colors, same system)
- Layout creativity (grids, asymmetry)
- Illustration style
- Animation personality
- Feature-specific interactions
- Hero section design
- Card styling variations
- Background patterns or textures

---

## Technical Excellence

### Performance
- Optimize images (WebP, lazy loading)
- Code splitting for faster loads
- Debounce search inputs
- Virtualize long lists
- Minimize re-renders
- Use proper memoization

### Accessibility
- Keyboard navigation throughout
- ARIA labels where needed
- Focus indicators visible
- Screen reader friendly
- Sufficient color contrast
- Respect reduced motion preferences

---

## Key Principles

1. **Be Bold** - Don't be afraid to try unique layouts and interactions
2. **Be Consistent** - Use the same patterns for similar functions
3. **Be Responsive** - Design works beautifully on all devices
4. **Be Fast** - Animations are smooth, loading is quick
5. **Be Accessible** - Everyone can use what you build
6. **Be Modern** - Use current design trends and technologies
7. **Be Unique** - Each project should have its own personality
8. **Be Intuitive** - Users shouldn't need instructions


*IMPORTANT*: For every page or component refer to # Modern Design Best Practices

## Philosophy

Create unique, memorable experiences while maintaining consistency through modern design principles. Every project should feel distinct yet professional, innovative yet intuitive.

---

## Landing Pages & Marketing Sites

### Hero Sections
**Go beyond static backgrounds:**
- Animated gradients with subtle movement
- Particle systems or geometric shapes floating
- Interactive canvas backgrounds (Three.js, WebGL)
- Video backgrounds with proper fallbacks
- Parallax scrolling effects
- Gradient mesh animations
- Morphing blob animations


### Layout Patterns
**Use modern grid systems:**
- Bento grids (asymmetric card layouts)
- Masonry layouts for varied content
- Feature sections with diagonal cuts or curves
- Overlapping elements with proper z-index
- Split-screen designs with scroll-triggered reveals

**Avoid:** Traditional 3-column equal grids

### Scroll Animations
**Engage users as they scroll:**
- Fade-in and slide-up animations for sections
- Scroll-triggered parallax effects
- Progress indicators for long pages
- Sticky elements that transform on scroll
- Horizontal scroll sections for portfolios
- Text reveal animations (word by word, letter by letter)
- Number counters animating into view

**Avoid:** Static pages with no scroll interaction

### Call-to-Action Areas
**Make CTAs impossible to miss:**
- Gradient buttons with hover effects
- Floating action buttons with micro-interactions
- Animated borders or glowing effects
- Scale/lift on hover
- Interactive elements that respond to mouse position
- Pulsing indicators for primary actions

---

## Dashboard Applications

### Layout Structure
**Always use collapsible side navigation:**
- Sidebar that can collapse to icons only
- Smooth transition animations between states
- Persistent navigation state (remember user preference)
- Mobile: drawer that slides in/out
- Desktop: sidebar with expand/collapse toggle
- Icons visible even when collapsed

**Structure:**
```
/dashboard (layout wrapper with sidebar)
  /dashboard/overview
  /dashboard/analytics
  /dashboard/settings
  /dashboard/users
  /dashboard/projects
```

All dashboard pages should be nested inside the dashboard layout, not separate routes.

### Data Tables
**Modern table design:**
- Sticky headers on scroll
- Row hover states with subtle elevation
- Sortable columns with clear indicators
- Pagination with items-per-page control
- Search/filter with instant feedback
- Selection checkboxes with bulk actions
- Responsive: cards on mobile, table on desktop
- Loading skeletons, not spinners
- Empty states with illustrations or helpful text

**Use modern table libraries:**
- TanStack Table (React Table v8)
- AG Grid for complex data
- Data Grid from MUI (if using MUI)

### Charts & Visualizations
**Use the latest charting libraries:**
- Recharts (for React, simple charts)
- Chart.js v4 (versatile, well-maintained)
- Apache ECharts (advanced, interactive)
- D3.js (custom, complex visualizations)
- Tremor (for dashboards, built on Recharts)

**Chart best practices:**
- Animated transitions when data changes
- Interactive tooltips with detailed info
- Responsive sizing
- Color scheme matching design system
- Legend placement that doesn't obstruct data
- Loading states while fetching data

### Dashboard Cards
**Metric cards should stand out:**
- Gradient backgrounds or colored accents
- Trend indicators (↑ ↓ with color coding)
- Sparkline charts for historical data
- Hover effects revealing more detail
- Icon representing the metric
- Comparison to previous period

---

## Color & Visual Design

### Color Palettes
**Create depth with gradients:**
- Primary gradient (not just solid primary color)
- Subtle background gradients
- Gradient text for headings
- Gradient borders on cards
- Elevated surfaces for depth

**Color usage:**
- 60-30-10 rule (dominant, secondary, accent)
- Consistent semantic colors (success, warning, error)
- Accessible contrast ratios (WCAG AA minimum)

### Typography
**Create hierarchy through contrast:**
- Large, bold headings (48-72px for heroes)
- Clear size differences between levels
- Variable font weights (300, 400, 600, 700)
- Letter spacing for small caps
- Line height 1.5-1.7 for body text
- Inter, Poppins, or DM Sans for modern feel

### Shadows & Depth
**Layer UI elements:**
- Multi-layer shadows for realistic depth
- Colored shadows matching element color
- Elevated states on hover
- Neumorphism for special elements (sparingly)

---

## Interactions & Micro-animations

### Button Interactions
**Every button should react:**
- Scale slightly on hover (1.02-1.05)
- Lift with shadow on hover
- Ripple effect on click
- Loading state with spinner or progress
- Disabled state clearly visible
- Success state with checkmark animation

### Card Interactions
**Make cards feel alive:**
- Lift on hover with increased shadow
- Subtle border glow on hover
- Tilt effect following mouse (3D transform)
- Smooth transitions (200-300ms)
- Click feedback for interactive cards

### Form Interactions
**Guide users through forms:**
- Input focus states with border color change
- Floating labels that animate up
- Real-time validation with inline messages
- Success checkmarks for valid inputs
- Error states with shake animation
- Password strength indicators
- Character count for text areas

### Page Transitions
**Smooth between views:**
- Fade + slide for page changes
- Skeleton loaders during data fetch
- Optimistic UI updates
- Stagger animations for lists
- Route transition animations

---

## Mobile Responsiveness

### Mobile-First Approach
**Design for mobile, enhance for desktop:**
- Touch targets minimum 44x44px
- Generous padding and spacing
- Sticky bottom navigation on mobile
- Collapsible sections for long content
- Swipeable cards and galleries
- Pull-to-refresh where appropriate

### Responsive Patterns
**Adapt layouts intelligently:**
- Hamburger menu → full nav bar
- Card grid → stack on mobile
- Sidebar → drawer
- Multi-column → single column
- Data tables → card list
- Hide/show elements based on viewport

---

## Loading & Empty States

### Loading States
**Never leave users wondering:**
- Skeleton screens matching content layout
- Progress bars for known durations
- Animated placeholders
- Spinners only for short waits (<3s)
- Stagger loading for multiple elements
- Shimmer effects on skeletons

### Empty States
**Make empty states helpful:**
- Illustrations or icons
- Helpful copy explaining why it's empty
- Clear CTA to add first item
- Examples or suggestions
- No "no data" text alone

---

## Unique Elements to Stand Out

### Distinctive Features
**Add personality:**
- Custom cursor effects on landing pages
- Animated page numbers or section indicators
- Unusual hover effects (magnification, distortion)
- Custom scrollbars
- Glassmorphism for overlays
- Animated SVG icons
- Typewriter effects for hero text
- Confetti or celebration animations for actions

### Interactive Elements
**Engage users:**
- Drag-and-drop interfaces
- Sliders and range controls
- Toggle switches with animations
- Progress steps with animations
- Expandable/collapsible sections
- Tabs with slide indicators
- Image comparison sliders
- Interactive demos or playgrounds

---

## Consistency Rules

### Maintain Consistency
**What should stay consistent:**
- Spacing scale (4px, 8px, 16px, 24px, 32px, 48px, 64px)
- Border radius values
- Animation timing (200ms, 300ms, 500ms)
- Color system (primary, secondary, accent, neutrals)
- Typography scale
- Icon style (outline vs filled)
- Button styles across the app
- Form element styles

### What Can Vary
**Project-specific customization:**
- Color palette (different colors, same system)
- Layout creativity (grids, asymmetry)
- Illustration style
- Animation personality
- Feature-specific interactions
- Hero section design
- Card styling variations
- Background patterns or textures

---

## Technical Excellence

### Performance
- Optimize images (WebP, lazy loading)
- Code splitting for faster loads
- Debounce search inputs
- Virtualize long lists
- Minimize re-renders
- Use proper memoization

### Accessibility
- Keyboard navigation throughout
- ARIA labels where needed
- Focus indicators visible
- Screen reader friendly
- Sufficient color contrast
- Respect reduced motion preferences

---

## Key Principles

1. **Be Bold** - Don't be afraid to try unique layouts and interactions
2. **Be Consistent** - Use the same patterns for similar functions
3. **Be Responsive** - Design works beautifully on all devices
4. **Be Fast** - Animations are smooth, loading is quick
5. **Be Accessible** - Everyone can use what you build
6. **Be Modern** - Use current design trends and technologies
7. **Be Unique** - Each project should have its own personality
8. **Be Intuitive** - Users shouldn't need instructions
 for bestpractices and # Project Workspace Page

## Overview
Create the Project Workspace Page for Archject, a project-level workspace that aggregates decisions, project files, team members, templates, and a project overview (branding and settings). The page must integrate with client-facing no-login links, lightweight tasking and webhooks, robust search and filtering, branding customization, third-party integrations, and exportable decision logs. It should be mobile-friendly, accessible, and visually aligned with Archject’s design system. The page serves as the central hub for project administration, decision management, and client-facing interactions, while enabling secure sharing and integration with existing studio workflows and external tools.

## Page Description (Full Detail)
This page is the central, at-a-glance workspace for a given project. Its goals are to provide a single pane where users can:
- View and manage project branding (logo, accent color, and a custom client URL prefix or domain).
- Browse and manage Decisions (status, due dates, assignee, and quick previews), Files/Drawings (with versioning and previews), and Team Members (roles and permissions).
- Access a Decision Templates Library to accelerate decision creation (finishes, layouts, change requests).
- See a concise Project Overview including branding preview, settings, storage quotas, and template usage.
- Launch Client Portal links (no-login) to a lightweight client view for a specific decision or the project, with optional OTP verification or expiry.
- Create lightweight Tasks triggered by approval outcomes, with webhooks to Zapier, Google Calendar, and other PM/accounting tools.
- Filter and search across Projects, Decisions, Files, and Comments with full-text search and faceted filters.
- Export Decision Logs as human-readable PDFs or machine-readable CSV/JSON (including decisions, options, comments, approvals, and file references).
- Upload and manage project files (drawings, specs, images, BIM files) with versioning and CDN-backed delivery.
- Navigate via a consistent UI consisting of Cards, Tables, Sidebars, and a top navigation with clear hierarchy and action affordances.
- View activity/audit timeline and recent changes with filtering by type.
- Access a dashboard with personalized summaries (active projects, decisions awaiting client response, recent activity, quick actions).
- Manage project/workspace creation and branding templates, quotas, and lifecycle.

Connected features must be discoverable and actionable from this page:
- Client Portal & No-login Links: generate secure shareable links for decisions/projects; support expiry and OTP verification.
- Light Tasking & Webhooks: create tasks tied to approval outcomes; trigger webhooks/Zapier actions on status changes.
- Search & Filter: robust full-text search across multiple content types; faceted filters by project, decision status, file type, assignee, tags, dates, etc.
- Branding & Custom Links: set logos, accent colors, and a custom client-facing URL prefix or domain redirect for client links.
- Third-Party Integrations: hooks to Google Calendar, Autodesk Forge (BIM/CAD viewer), and Zapier.
- Exports: PDF/CSV/JSON exports of Decision Logs with comprehensive references.
- File Management: support versioning, preview generation, and CDN delivery for all file types.
- Decision Templates Library: prebuilt templates for common decisions to accelerate creation.
- Security & Compliance: export, retention policies, audit logs, and enterprise privacy controls.

Visual style and UI elements must adhere to the provided design system, with clear emphasis on usability, readability, and a professional aesthetic.

## Components to Build
1) Project Header
- Elements: project name, client/logo area, status badge, branding preview, primary action buttons (Share client portal, Export Decision Log), quick stats (decisions, files, storage usage).
- Interaction: edit branding, update project status, launch client links.

2) Left Navigation / Contextual Panels (collapsible)
- Sections: Overview, Decisions, Files & Drawings, Team & Permissions, Templates, Activity & Audit, Settings.
- Visuals: pill-shaped active tab in deep green (#195C4A); content area to the right.

3) Overview Card
- Branding area (logo, accent color preview, domain/prefix), storage quota, template usage, project metadata (deadline, client name, project type).

4) Decisions List
- Presentation: card or table with status chips (draft/pending/approved/rejected), due date, assignee, last updated, and a compact preview.
- Actions: quick open, apply template, create/edit decision, export related logs.

5) Files & Drawings Library
- Upload area with drag-and-drop; file cards with thumbnails/previews, version number, last modified, and per-file actions (preview, download, link to decision).
- CDN-backed delivery indicators.

6) Team & Permissions Panel
- Member list with roles; invite modal for clients; per-project roles; permission scopes; add/remove members.

7) Templates Library
- Browse templates; apply to create a new decision; template detail view; tag-based filtering.

8) Activity & Audit Sidebar
- Timeline view of decisions, approvals, comments, file uploads; filter by type; quick-view for details.

9) Client Portal Link Manager
- Generate & manage no-login client links; expiry date, OTP requirement toggle; copy/share URL; link list per project/decision.

10) Create / Edit Decision Page (Modal or Page)
- Multi-step editor: metadata, options upload (images/specs/layouts), side-by-side comparison, approval rules, assignee, reminders, attachments, and final save.

11) Decision Log Exporter
- PDF export: human-readable with structured layout; CSV/JSON export for machine processing; include decisions, options, comments, approvals, and file references.

12) Search & Filter Panel
- Global search bar with scope selector; facet panel with filters for projects, decisions, files, comments; dynamic counts and saved views.

13) Webhook & Tasking Center
- Create lightweight tasks triggered by decision outcomes; map to external actions; show status and history.

14) Integrations Hub (Lightweight)
- Config panels for Google Calendar, Autodesk Forge (viewer links), Zapier webhooks; allow enabling/disabling per project.

15) Settings & Compliance Panel
- Retention policies, export controls, audit logs access, data export formats, and privacy controls.

## Implementation Requirements

### Frontend
- Build a responsive, single-page experience with a persistent top navigation and a two-column main content layout on larger viewports; a stacked, mobile-friendly layout on smaller screens.
- Reusable UI primitives that conform to the design system:
  - Card component with shadow, rounded corners, padding, hover elevation.
  - Tabs/Pills for navigation with active state coloring.
  - Data Table or Card Grid for Decisions; expandable rows for details.
  - Preview components for files (thumbnails, BIM previews), decision option comparisons side-by-side.
  - Avatar/Member chips with role labels.
  - Branding editor: color picker, logo uploader, domain/prefix editor.
  - Client Link Card: copy/share button with expiry/OTP indicators.
- Accessibility: ARIA roles, keyboard navigation, color contrast compliance, focus states.
- State management: Centralized store (e.g., React context or Redux) to coordinate project data, search filters, and user permissions.
- Internationalization (i18n) hooks ready if needed later.
- Performance: virtualization for long lists, debounce search input, lazy-loaded previews, CDN-backed image handling.
- Testing: unit tests for components, integration tests for key flows (create decision, share client link, export logs).

### Backend
- Databases:
  - Projects table: id, name, client_id, branding_logo_url, branding_color, domain_prefix, storage_quota_bytes, current_storage_bytes, created_at, updated_at.
  - Decisions table: id, project_id, title, status, due_date, assignee_id, created_by, created_at, updated_at, description.
  - DecisionOptions table: id, decision_id, title, description, media_url, order, version.
  - Files table: id, project_id, file_type (drawing/spec/image/BIM), file_url, version, uploaded_by, uploaded_at, associated_decision_id.
  - Teams table: id, project_id, user_id, role, permissions_json, invited_at, accepted_at.
  - Templates table: id, name, type (finishes/layouts/change_request), content_json, created_at.
  - ClientLinks table: id, project_id, decision_id, url, expires_at, otp_required, otp_secret, created_at, used_at.
  - Webhooks table: id, project_id, event_type, target_url, last_trigger_at, attempts, status.
  - Tasks table: id, project_id, related_decision_id, description, status, due_at, created_by, assigned_to.
  - ActivityLog table: id, project_id, type, reference_id, details_json, created_at.
  - Exports table: id, project_id, type (pdf/csv/json), status, file_url, created_at.
  - BrandingTemplates table: id, name, logo_url, color, domain_prefix_suggestion, created_at.
- APIs:
  - Project CRUD: create/read/update/delete projects; manage branding and quotas.
  - Decision CRUD: create/edit/delete/preview decisions; attach options; link to decisions with assignees and reminders.
  - File Management: upload with versioning; generate previews; CDN URL provisioning; thumbnail creation.
  - Team & Permissions: invite peers/clients; role assignment; permission scoping.
  - Templates: library browse/apply templates to decisions; create/update templates.
  - Client Portal Links: generate links with expiry and OTP; validate OTP; revoke/expire links; audit trail for link usage.
  - Search API: full-text search across projects, decisions, files, and comments; facet counts.
  - Exports: generate PDF/CSV/JSON exports; streaming or downloadable URLs; include references to attached files and decisions.
  - Webhooks: trigger on decision status changes; deliver payloads to Zapier, calendar apps, and PM/accounting tools.
  - Integrations: endpoints to configure Google Calendar events, Autodesk Forge viewer URLs, and Zapier webhooks.
  - Activity/Audit: query and filter logs; exportable audit summaries.
  - Storage & Quotas: enforce per-project quotas; warn and block uploads when exceeded.
- Data integrity:
  - Enforce referential integrity between decisions, files, and decisions’ options.
  - Soft-delete policies with archival in case of data retention.
- Security:
  - Authentication: OAuth2 / JWT tokens; SSO-ready.
  - Authorization: project-scoped roles; fine-grained permissions per action.
  - Data governance: export controls, retention policies, audit logs, privacy controls per industry standards.
  - OTP handling: time-based one-time passwords for no-login client access verification.
- Validation:
  - Validate input lengths, required fields, enum constraints (decision status), date formats, URL formats (custom domain/prefix).
  - File type validation and virus scanning hooks on upload.
  - Ensure uniqueness where required (e.g., client link per decision).

### Integration
- Frontend ↔ Backend: RESTful or GraphQL API endpoints with consistent response shapes; optimistic UI updates with reconciliation on server response.
- Webhooks: server-side integration with Zapier webhooks, Google Calendar events, and Autodesk Forge viewer sessions; support retries with exponential backoff.
- Third-party data: store external URLs (Forge viewer, calendar events) and refresh tokens securely; ensure webhook payloads contain enough metadata for downstream tools.
- Client Portal: frontend routes for no-login client views; OTP validation flow; ephemeral session management; permission scoping logic to restrict client visibility to the targeted decision or project.

## User Experience Flow
1) User lands on a Project Workspace Page:
   - See Project Header with branding, status, and quick actions.
   - View Overview with branding preview and quotas.
   - Access Decisions list, Files library, Team panel, Templates, and Activity.
2) Branding customization:
   - User edits logo and accent color; saves; branding preview updates; optional domain/prefix change available.
3) Create a Decision:
   - Open Create Decision (multi-step editor).
   - Enter metadata, upload options (images/specs/layouts), arrange side-by-side comparisons, set approvals, assign, and schedule reminders.
   - Save; decision appears in the Decisions list; optional template applied from the library.
4) Client Portal Share:
   - Generate a secure client link for a decision or project with optional expiry and OTP; share via copyable URL.
   - Client opens link, passes OTP if configured, views lightweight summary and decision options; client responses are captured and reflected in the Decision workflow.
5) Light Tasking & Webhooks:
   - On decision approval or status change, create a light task and trigger configured webhooks to Zapier/Cal/Forge as needed.
6) Search & Filters:
   - User uses global search to locate content across projects, decisions, files, and comments; applies facet filters to narrow results.
7) Exports:
   - User exports a Decision Log to PDF/CSV/JSON; file is generated and presented for download.
8) Uploads & File Management:
   - User uploads drawings/specs/BIM files; system versions files; previews generated; CDN URLs used for delivery.
9) Access & Security:
   - Admin reviews audit logs and export policies; ensure retention policies are enforced.

## Technical Specifications

Data Models: (Key Schemas)
- Project: id, name, client_id, branding_logo_url, branding_color, domain_prefix, storage_quota_bytes, current_storage_bytes, status, created_at, updated_at, archived.
- Decision: id, project_id, title, status, due_date, assignee_id, created_by, created_at, updated_at, description, template_id, approved_at.
- DecisionOption: id, decision_id, title, description, media_url, version, order.
- File: id, project_id, file_name, file_type, file_url, version, uploaded_by, uploaded_at, associated_decision_id, is_preview_generated, mime_type.
- TeamMember: id, project_id, user_id, role, permissions_json, invited_at, accepted_at.
- Template: id, name, type, content_json, created_at, updated_at.
- ActivityLog: id, project_id, type, reference_id, details_json, created_at.
- ClientLink: id, project_id, decision_id, url, expires_at, otp_required, otp_secret, created_at, used_at, is_active.
- Webhook: id, project_id, event_type, target_url, last_trigger_at, status, attempts, payload_template_json.
- Task: id, project_id, related_decision_id, description, status, due_at, created_by, assigned_to, created_at, completed_at.
- Export: id, project_id, type, status, file_url, created_at, user_id.

API Endpoints (Examples)
- GET /api/projects/{projectId} // fetch project details (branding, quotas, overview)
- PUT /api/projects/{projectId} // update branding, quotas, domain prefix
- POST /api/projects/{projectId}/decisions // create decision
- GET /api/projects/{projectId}/decisions // list decisions
- GET /api/decisions/{decisionId} // decision detail
- POST /api/decisions/{decisionId}/options // add option to decision
- POST /api/projects/{projectId}/files // upload file
- GET /api/projects/{projectId}/files // list files
- POST /api/projects/{projectId}/team // add/invite team member
- GET /api/templates // list templates
- POST /api/projects/{projectId}/templates/{templateId}/apply // apply template to new decision
- POST /api/client-links // create client portal link
- POST /api/webhooks // configure webhook
- POST /api/projects/{projectId}/tasks // create light task
- POST /api/projects/{projectId}/exports // create export (PDF/CSV/JSON)
- GET /api/search // global search with filters
- GET /api/projects/{projectId}/activity // activity logs
- POST /api/projects/{projectId}/branding/otp // enable OTP for client portal
- POST /api/projects/{projectId}/branding/otp/verify // verify OTP

Security
- Authentication: OAuth2 / JWT; session-based on web UI; SSO-ready.
- Authorization: Per-project roles (Owner, Editor, Viewer, Client); enforce scope-limited access to content based on role.
- Data Privacy: retention policies configurable per project; audit logs stored immutable for a defined period; export endpoints respect data governance.
- Client Portal OTP: implement time-based OTP; verify with server-side validation; scope client access only to the intended project/decision.

Validation
- Input validation: required fields, max lengths, valid dates, valid URLs for domain/prefix, and file type guarantees.
- File uploads: allowed MIME types per type; size limits; virus scanning hooks.
- Decision status enums: ["draft","pending","approved","rejected"].
- OTP flows: one-time use and expiry handling; rate-limiting on OTP requests.

Acceptance Criteria
- [ ] The Project Workspace Page renders branding, decisions, files, team, templates, and activity panels with responsive layout and accessible UI.
- [ ] Client Portal Link generation supports expiry and OTP verification; links open in a lightweight viewer and respect access restrictions.
- [ ] Full-text search with facets returns accurate results across projects, decisions, files, and comments; filters update results in real time.
- [ ] Decision creation supports multi-step editor with metadata, options upload, side-by-side comparisons, approvals, assignments, and reminders; templates can be applied.
- [ ] Exports produce correctly formatted PDFs and CSV/JSON with all necessary references (decisions, options, comments, approvals, file references).
- [ ] File uploads support versioning, previews, and CDN-backed delivery; storage quotas enforced with user-friendly warnings.
- [ ] Webhooks and Tasks fire on decision status changes and integrate with Zapier/Google Calendar/Forge accordingly; retries and idempotency are in place.
- [ ] Security policies enforced: per-project roles, audit logs, data export controls, and OTP-based client access where configured.

UI/UX Guidelines
Apply the project’s design system:
- Clean card-based layout with generous whitespace.
- Primary actions use Deep Green (#195C4A); success indicators Bright Green (#7BE495); warnings soft yellow (#FFE8A3) and orange hues as indicated; destructive actions use Light Red (#FF6C6C).
- Text: Dark gray headings (#23272F); medium gray labels (#6B7280); body text in regular weight.
- Components use rounded corners (12-16px) and 8px spacing increments.
- Cards have subtle shadows (0 4px 16px rgba(34,42,89,0.05)); hover elevates slightly; background shift to #F7F8FA on hover.
- Typography: Inter/SF Pro/Manrope family; weights 400/500/600; large headings; medium section titles; body text 400.
- Mobile-first: responsive grid with vertical stacking; large tap targets; accessible focus states.

Visual Style
- Color Palette and branding exactly as described in the Visual Style sections above.
- All components should be card-based, with consistent typography and spacing.
- Data visualizations (if used) should follow the chart styling guidelines: clean lines, subtle grids, color accents for status.

Connected Pages
- Dashboard: User-specific dashboard with quick actions to create a decision or share client links.
- Team & Users Page: Manage team members, invite clients, set project-level roles, review permission scopes.
- Files & Drawings Library: Central repository for project drawings, specs, BIM files with versioning and previews.
- Create / Edit Decision Page: Multi-step editor with metadata, options, side-by-side comparisons, approvals, assignees, and reminders.

Connected Features
- Client Portal & No-login Links
- Light Tasking & Webhook Triggers
- Search & Filter Functionality
- Workspace Branding & Custom Links
- Third-Party Integrations & Webhooks
- Project & Workspace Management
- Decision Log Exports (PDF/CSV/JSON)
- File Upload & Management
- Decision Templates Library
- Security, Privacy & Compliance

Technical Deliverables
- Full-stack implementation plan with component-level UI specs, backend data model migrations, API contracts, and integration points.
- API schema definitions (JSON Schema or OpenAPI 3.0) including request/response formats, error models, and pagination.
- Database migration scripts for new tables/fields.
- Deployment plan for feature flags, migrations, and canary releases.
- Mock data and seed scripts for local development.
- Testing strategy: unit, integration, and end-to-end tests; include test cases for client portal OTP, exports, and webhook triggers.
- Documentation: developer-ready docs for API usage, data models, and onboarding steps for branding and client links.

Notes
- No external APIs are assumed to be connected at this stage, but the design should be integration-ready for Google Calendar, Autodesk Forge, and Zapier.
- Ensure robust handling of large projects with many decisions and files, including performance optimizations and pagination.
- Emphasize a frictionless client experience with no-login access while preserving strong security and auditability for the studio.

This prompt is ready to feed into an AI development tool to generate code scaffolding, UI components, API contracts, and an end-to-end implementation plan for the Project Workspace Page. for style.

CRITICAL DESIGN REQUIREMENTS:
- You MUST follow ALL design principles and patterns specified in the Design Reference above
- Do NOT deviate from the design specifications without explicit user permission
- Implement ALL visual design elements (colors, typography, spacing, shadows, animations) as specified
- Follow the layout patterns and component designs exactly as documented
- Ensure all interactions and micro-animations match the reference specifications

CRITICAL TECHNICAL REQUIREMENTS:
- React 18.3.1, React Router 6.30.1
- Tailwind CSS v3 with tailwind.config.js and custom keyframes
- @tailwindcss/typography plugin for rich text content
- Tailwind CSS animations (NOT Motion library or framer-motion)
- Sonner for toasts
- Recharts for data visualization
- Native fetch() with API utilities in src/lib/api.ts
- Design system with CSS custom properties
- Use RGB color values for theming
- When Supabase is configured: use Edge Functions for LLM and server-only logic; never expose API keys in the client

=== TASK ===
# Project Workspace Page

## Overview
Create the Project Workspace Page for Archject, a project-level workspace that aggregates decisions, project files, team members, templates, and a project overview (branding and settings). The page must integrate with client-facing no-login links, lightweight tasking and webhooks, robust search and filtering, branding customization, third-party integrations, and exportable decision logs. It should be mobile-friendly, accessible, and visually aligned with Archject’s design system. The page serves as the central hub for project administration, decision management, and client-facing interactions, while enabling secure sharing and integration with existing studio workflows and external tools.

## Page Description (Full Detail)
This page is the central, at-a-glance workspace for a given project. Its goals are to provide a single pane where users can:
- View and manage project branding (logo, accent color, and a custom client URL prefix or domain).
- Browse and manage Decisions (status, due dates, assignee, and quick previews), Files/Drawings (with versioning and previews), and Team Members (roles and permissions).
- Access a Decision Templates Library to accelerate decision creation (finishes, layouts, change requests).
- See a concise Project Overview including branding preview, settings, storage quotas, and template usage.
- Launch Client Portal links (no-login) to a lightweight client view for a specific decision or the project, with optional OTP verification or expiry.
- Create lightweight Tasks triggered by approval outcomes, with webhooks to Zapier, Google Calendar, and other PM/accounting tools.
- Filter and search across Projects, Decisions, Files, and Comments with full-text search and faceted filters.
- Export Decision Logs as human-readable PDFs or machine-readable CSV/JSON (including decisions, options, comments, approvals, and file references).
- Upload and manage project files (drawings, specs, images, BIM files) with versioning and CDN-backed delivery.
- Navigate via a consistent UI consisting of Cards, Tables, Sidebars, and a top navigation with clear hierarchy and action affordances.
- View activity/audit timeline and recent changes with filtering by type.
- Access a dashboard with personalized summaries (active projects, decisions awaiting client response, recent activity, quick actions).
- Manage project/workspace creation and branding templates, quotas, and lifecycle.

Connected features must be discoverable and actionable from this page:
- Client Portal & No-login Links: generate secure shareable links for decisions/projects; support expiry and OTP verification.
- Light Tasking & Webhooks: create tasks tied to approval outcomes; trigger webhooks/Zapier actions on status changes.
- Search & Filter: robust full-text search across multiple content types; faceted filters by project, decision status, file type, assignee, tags, dates, etc.
- Branding & Custom Links: set logos, accent colors, and a custom client-facing URL prefix or domain redirect for client links.
- Third-Party Integrations: hooks to Google Calendar, Autodesk Forge (BIM/CAD viewer), and Zapier.
- Exports: PDF/CSV/JSON exports of Decision Logs with comprehensive references.
- File Management: support versioning, preview generation, and CDN delivery for all file types.
- Decision Templates Library: prebuilt templates for common decisions to accelerate creation.
- Security & Compliance: export, retention policies, audit logs, and enterprise privacy controls.

Visual style and UI elements must adhere to the provided design system, with clear emphasis on usability, readability, and a professional aesthetic.

## Components to Build
1) Project Header
- Elements: project name, client/logo area, status badge, branding preview, primary action buttons (Share client portal, Export Decision Log), quick stats (decisions, files, storage usage).
- Interaction: edit branding, update project status, launch client links.

2) Left Navigation / Contextual Panels (collapsible)
- Sections: Overview, Decisions, Files & Drawings, Team & Permissions, Templates, Activity & Audit, Settings.
- Visuals: pill-shaped active tab in deep green (#195C4A); content area to the right.

3) Overview Card
- Branding area (logo, accent color preview, domain/prefix), storage quota, template usage, project metadata (deadline, client name, project type).

4) Decisions List
- Presentation: card or table with status chips (draft/pending/approved/rejected), due date, assignee, last updated, and a compact preview.
- Actions: quick open, apply template, create/edit decision, export related logs.

5) Files & Drawings Library
- Upload area with drag-and-drop; file cards with thumbnails/previews, version number, last modified, and per-file actions (preview, download, link to decision).
- CDN-backed delivery indicators.

6) Team & Permissions Panel
- Member list with roles; invite modal for clients; per-project roles; permission scopes; add/remove members.

7) Templates Library
- Browse templates; apply to create a new decision; template detail view; tag-based filtering.

8) Activity & Audit Sidebar
- Timeline view of decisions, approvals, comments, file uploads; filter by type; quick-view for details.

9) Client Portal Link Manager
- Generate & manage no-login client links; expiry date, OTP requirement toggle; copy/share URL; link list per project/decision.

10) Create / Edit Decision Page (Modal or Page)
- Multi-step editor: metadata, options upload (images/specs/layouts), side-by-side comparison, approval rules, assignee, reminders, attachments, and final save.

11) Decision Log Exporter
- PDF export: human-readable with structured layout; CSV/JSON export for machine processing; include decisions, options, comments, approvals, and file references.

12) Search & Filter Panel
- Global search bar with scope selector; facet panel with filters for projects, decisions, files, comments; dynamic counts and saved views.

13) Webhook & Tasking Center
- Create lightweight tasks triggered by decision outcomes; map to external actions; show status and history.

14) Integrations Hub (Lightweight)
- Config panels for Google Calendar, Autodesk Forge (viewer links), Zapier webhooks; allow enabling/disabling per project.

15) Settings & Compliance Panel
- Retention policies, export controls, audit logs access, data export formats, and privacy controls.

## Implementation Requirements

### Frontend
- Build a responsive, single-page experience with a persistent top navigation and a two-column main content layout on larger viewports; a stacked, mobile-friendly layout on smaller screens.
- Reusable UI primitives that conform to the design system:
  - Card component with shadow, rounded corners, padding, hover elevation.
  - Tabs/Pills for navigation with active state coloring.
  - Data Table or Card Grid for Decisions; expandable rows for details.
  - Preview components for files (thumbnails, BIM previews), decision option comparisons side-by-side.
  - Avatar/Member chips with role labels.
  - Branding editor: color picker, logo uploader, domain/prefix editor.
  - Client Link Card: copy/share button with expiry/OTP indicators.
- Accessibility: ARIA roles, keyboard navigation, color contrast compliance, focus states.
- State management: Centralized store (e.g., React context or Redux) to coordinate project data, search filters, and user permissions.
- Internationalization (i18n) hooks ready if needed later.
- Performance: virtualization for long lists, debounce search input, lazy-loaded previews, CDN-backed image handling.
- Testing: unit tests for components, integration tests for key flows (create decision, share client link, export logs).

### Backend
- Databases:
  - Projects table: id, name, client_id, branding_logo_url, branding_color, domain_prefix, storage_quota_bytes, current_storage_bytes, created_at, updated_at.
  - Decisions table: id, project_id, title, status, due_date, assignee_id, created_by, created_at, updated_at, description.
  - DecisionOptions table: id, decision_id, title, description, media_url, order, version.
  - Files table: id, project_id, file_type (drawing/spec/image/BIM), file_url, version, uploaded_by, uploaded_at, associated_decision_id.
  - Teams table: id, project_id, user_id, role, permissions_json, invited_at, accepted_at.
  - Templates table: id, name, type (finishes/layouts/change_request), content_json, created_at.
  - ClientLinks table: id, project_id, decision_id, url, expires_at, otp_required, otp_secret, created_at, used_at.
  - Webhooks table: id, project_id, event_type, target_url, last_trigger_at, attempts, status.
  - Tasks table: id, project_id, related_decision_id, description, status, due_at, created_by, assigned_to.
  - ActivityLog table: id, project_id, type, reference_id, details_json, created_at.
  - Exports table: id, project_id, type (pdf/csv/json), status, file_url, created_at.
  - BrandingTemplates table: id, name, logo_url, color, domain_prefix_suggestion, created_at.
- APIs:
  - Project CRUD: create/read/update/delete projects; manage branding and quotas.
  - Decision CRUD: create/edit/delete/preview decisions; attach options; link to decisions with assignees and reminders.
  - File Management: upload with versioning; generate previews; CDN URL provisioning; thumbnail creation.
  - Team & Permissions: invite peers/clients; role assignment; permission scoping.
  - Templates: library browse/apply templates to decisions; create/update templates.
  - Client Portal Links: generate links with expiry and OTP; validate OTP; revoke/expire links; audit trail for link usage.
  - Search API: full-text search across projects, decisions, files, and comments; facet counts.
  - Exports: generate PDF/CSV/JSON exports; streaming or downloadable URLs; include references to attached files and decisions.
  - Webhooks: trigger on decision status changes; deliver payloads to Zapier, calendar apps, and PM/accounting tools.
  - Integrations: endpoints to configure Google Calendar events, Autodesk Forge viewer URLs, and Zapier webhooks.
  - Activity/Audit: query and filter logs; exportable audit summaries.
  - Storage & Quotas: enforce per-project quotas; warn and block uploads when exceeded.
- Data integrity:
  - Enforce referential integrity between decisions, files, and decisions’ options.
  - Soft-delete policies with archival in case of data retention.
- Security:
  - Authentication: OAuth2 / JWT tokens; SSO-ready.
  - Authorization: project-scoped roles; fine-grained permissions per action.
  - Data governance: export controls, retention policies, audit logs, privacy controls per industry standards.
  - OTP handling: time-based one-time passwords for no-login client access verification.
- Validation:
  - Validate input lengths, required fields, enum constraints (decision status), date formats, URL formats (custom domain/prefix).
  - File type validation and virus scanning hooks on upload.
  - Ensure uniqueness where required (e.g., client link per decision).

### Integration
- Frontend ↔ Backend: RESTful or GraphQL API endpoints with consistent response shapes; optimistic UI updates with reconciliation on server response.
- Webhooks: server-side integration with Zapier webhooks, Google Calendar events, and Autodesk Forge viewer sessions; support retries with exponential backoff.
- Third-party data: store external URLs (Forge viewer, calendar events) and refresh tokens securely; ensure webhook payloads contain enough metadata for downstream tools.
- Client Portal: frontend routes for no-login client views; OTP validation flow; ephemeral session management; permission scoping logic to restrict client visibility to the targeted decision or project.

## User Experience Flow
1) User lands on a Project Workspace Page:
   - See Project Header with branding, status, and quick actions.
   - View Overview with branding preview and quotas.
   - Access Decisions list, Files library, Team panel, Templates, and Activity.
2) Branding customization:
   - User edits logo and accent color; saves; branding preview updates; optional domain/prefix change available.
3) Create a Decision:
   - Open Create Decision (multi-step editor).
   - Enter metadata, upload options (images/specs/layouts), arrange side-by-side comparisons, set approvals, assign, and schedule reminders.
   - Save; decision appears in the Decisions list; optional template applied from the library.
4) Client Portal Share:
   - Generate a secure client link for a decision or project with optional expiry and OTP; share via copyable URL.
   - Client opens link, passes OTP if configured, views lightweight summary and decision options; client responses are captured and reflected in the Decision workflow.
5) Light Tasking & Webhooks:
   - On decision approval or status change, create a light task and trigger configured webhooks to Zapier/Cal/Forge as needed.
6) Search & Filters:
   - User uses global search to locate content across projects, decisions, files, and comments; applies facet filters to narrow results.
7) Exports:
   - User exports a Decision Log to PDF/CSV/JSON; file is generated and presented for download.
8) Uploads & File Management:
   - User uploads drawings/specs/BIM files; system versions files; previews generated; CDN URLs used for delivery.
9) Access & Security:
   - Admin reviews audit logs and export policies; ensure retention policies are enforced.

## Technical Specifications

Data Models: (Key Schemas)
- Project: id, name, client_id, branding_logo_url, branding_color, domain_prefix, storage_quota_bytes, current_storage_bytes, status, created_at, updated_at, archived.
- Decision: id, project_id, title, status, due_date, assignee_id, created_by, created_at, updated_at, description, template_id, approved_at.
- DecisionOption: id, decision_id, title, description, media_url, version, order.
- File: id, project_id, file_name, file_type, file_url, version, uploaded_by, uploaded_at, associated_decision_id, is_preview_generated, mime_type.
- TeamMember: id, project_id, user_id, role, permissions_json, invited_at, accepted_at.
- Template: id, name, type, content_json, created_at, updated_at.
- ActivityLog: id, project_id, type, reference_id, details_json, created_at.
- ClientLink: id, project_id, decision_id, url, expires_at, otp_required, otp_secret, created_at, used_at, is_active.
- Webhook: id, project_id, event_type, target_url, last_trigger_at, status, attempts, payload_template_json.
- Task: id, project_id, related_decision_id, description, status, due_at, created_by, assigned_to, created_at, completed_at.
- Export: id, project_id, type, status, file_url, created_at, user_id.

API Endpoints (Examples)
- GET /api/projects/{projectId} // fetch project details (branding, quotas, overview)
- PUT /api/projects/{projectId} // update branding, quotas, domain prefix
- POST /api/projects/{projectId}/decisions // create decision
- GET /api/projects/{projectId}/decisions // list decisions
- GET /api/decisions/{decisionId} // decision detail
- POST /api/decisions/{decisionId}/options // add option to decision
- POST /api/projects/{projectId}/files // upload file
- GET /api/projects/{projectId}/files // list files
- POST /api/projects/{projectId}/team // add/invite team member
- GET /api/templates // list templates
- POST /api/projects/{projectId}/templates/{templateId}/apply // apply template to new decision
- POST /api/client-links // create client portal link
- POST /api/webhooks // configure webhook
- POST /api/projects/{projectId}/tasks // create light task
- POST /api/projects/{projectId}/exports // create export (PDF/CSV/JSON)
- GET /api/search // global search with filters
- GET /api/projects/{projectId}/activity // activity logs
- POST /api/projects/{projectId}/branding/otp // enable OTP for client portal
- POST /api/projects/{projectId}/branding/otp/verify // verify OTP

Security
- Authentication: OAuth2 / JWT; session-based on web UI; SSO-ready.
- Authorization: Per-project roles (Owner, Editor, Viewer, Client); enforce scope-limited access to content based on role.
- Data Privacy: retention policies configurable per project; audit logs stored immutable for a defined period; export endpoints respect data governance.
- Client Portal OTP: implement time-based OTP; verify with server-side validation; scope client access only to the intended project/decision.

Validation
- Input validation: required fields, max lengths, valid dates, valid URLs for domain/prefix, and file type guarantees.
- File uploads: allowed MIME types per type; size limits; virus scanning hooks.
- Decision status enums: ["draft","pending","approved","rejected"].
- OTP flows: one-time use and expiry handling; rate-limiting on OTP requests.

Acceptance Criteria
- [ ] The Project Workspace Page renders branding, decisions, files, team, templates, and activity panels with responsive layout and accessible UI.
- [ ] Client Portal Link generation supports expiry and OTP verification; links open in a lightweight viewer and respect access restrictions.
- [ ] Full-text search with facets returns accurate results across projects, decisions, files, and comments; filters update results in real time.
- [ ] Decision creation supports multi-step editor with metadata, options upload, side-by-side comparisons, approvals, assignments, and reminders; templates can be applied.
- [ ] Exports produce correctly formatted PDFs and CSV/JSON with all necessary references (decisions, options, comments, approvals, file references).
- [ ] File uploads support versioning, previews, and CDN-backed delivery; storage quotas enforced with user-friendly warnings.
- [ ] Webhooks and Tasks fire on decision status changes and integrate with Zapier/Google Calendar/Forge accordingly; retries and idempotency are in place.
- [ ] Security policies enforced: per-project roles, audit logs, data export controls, and OTP-based client access where configured.

UI/UX Guidelines
Apply the project’s design system:
- Clean card-based layout with generous whitespace.
- Primary actions use Deep Green (#195C4A); success indicators Bright Green (#7BE495); warnings soft yellow (#FFE8A3) and orange hues as indicated; destructive actions use Light Red (#FF6C6C).
- Text: Dark gray headings (#23272F); medium gray labels (#6B7280); body text in regular weight.
- Components use rounded corners (12-16px) and 8px spacing increments.
- Cards have subtle shadows (0 4px 16px rgba(34,42,89,0.05)); hover elevates slightly; background shift to #F7F8FA on hover.
- Typography: Inter/SF Pro/Manrope family; weights 400/500/600; large headings; medium section titles; body text 400.
- Mobile-first: responsive grid with vertical stacking; large tap targets; accessible focus states.

Visual Style
- Color Palette and branding exactly as described in the Visual Style sections above.
- All components should be card-based, with consistent typography and spacing.
- Data visualizations (if used) should follow the chart styling guidelines: clean lines, subtle grids, color accents for status.

Connected Pages
- Dashboard: User-specific dashboard with quick actions to create a decision or share client links.
- Team & Users Page: Manage team members, invite clients, set project-level roles, review permission scopes.
- Files & Drawings Library: Central repository for project drawings, specs, BIM files with versioning and previews.
- Create / Edit Decision Page: Multi-step editor with metadata, options, side-by-side comparisons, approvals, assignees, and reminders.

Connected Features
- Client Portal & No-login Links
- Light Tasking & Webhook Triggers
- Search & Filter Functionality
- Workspace Branding & Custom Links
- Third-Party Integrations & Webhooks
- Project & Workspace Management
- Decision Log Exports (PDF/CSV/JSON)
- File Upload & Management
- Decision Templates Library
- Security, Privacy & Compliance

Technical Deliverables
- Full-stack implementation plan with component-level UI specs, backend data model migrations, API contracts, and integration points.
- API schema definitions (JSON Schema or OpenAPI 3.0) including request/response formats, error models, and pagination.
- Database migration scripts for new tables/fields.
- Deployment plan for feature flags, migrations, and canary releases.
- Mock data and seed scripts for local development.
- Testing strategy: unit, integration, and end-to-end tests; include test cases for client portal OTP, exports, and webhook triggers.
- Documentation: developer-ready docs for API usage, data models, and onboarding steps for branding and client links.

Notes
- No external APIs are assumed to be connected at this stage, but the design should be integration-ready for Google Calendar, Autodesk Forge, and Zapier.
- Ensure robust handling of large projects with many decisions and files, including performance optimizations and pagination.
- Emphasize a frictionless client experience with no-login access while preserving strong security and auditability for the studio.

This prompt is ready to feed into an AI development tool to generate code scaffolding, UI components, API contracts, and an end-to-end implementation plan for the Project Workspace Page.

=== SUCCESS CRITERIA ===
# Success Criteria Checklist

## Code Quality

### TypeScript
- [ ] No TypeScript errors (`tsc --noEmit` passes)
- [ ] All functions and components have proper type definitions
- [ ] No `any` types used (use `unknown` if type is truly unknown)
- [ ] Props interfaces defined for all components
- [ ] API responses have type definitions

### Code Standards
- [ ] All imports use path aliases (@/ prefix)
- [ ] Components follow the established naming convention
- [ ] Files are organized in correct directories
- [ ] No unused imports or variables
- [ ] Consistent code formatting

## Component Implementation

### UI Components
- [ ] Use shadcn/ui components (Button, Card, Input, etc.) instead of building from scratch
- [ ] All interactive elements have hover states
- [ ] Components use the `cn()` utility for class merging
- [ ] Proper TypeScript props interfaces defined
- [ ] Components are responsive (mobile, tablet, desktop)

### Animations
- [ ] Motion library used for all animations (NOT framer-motion)
- [ ] Page transitions implemented with fade/slide
- [ ] Interactive elements have whileHover/whileTap animations
- [ ] List items use stagger animations where appropriate
- [ ] Animations respect `prefers-reduced-motion`

### Icons
- [ ] Lucide React icons used consistently
- [ ] Icons have consistent sizing (h-4 w-4, h-5 w-5, h-6 w-6)
- [ ] Icon colors match design system (text-primary, text-muted-foreground)

## Data Management

### React Query
- [ ] All data fetching uses React Query hooks
- [ ] Query keys follow the established pattern
- [ ] Mutations invalidate related queries
- [ ] Loading and error states handled
- [ ] Optimistic updates implemented where appropriate

### Forms
- [ ] Forms use react-hook-form
- [ ] Validation uses Zod schemas
- [ ] Error messages display properly
- [ ] Form submission shows loading state
- [ ] Success/error feedback via toast notifications

### API Layer
- [ ] API functions in src/api/ directory
- [ ] Axios used for HTTP requests
- [ ] Proper error handling with try/catch
- [ ] Auth tokens handled by interceptors
- [ ] Type-safe API function signatures

## User Experience

### Notifications
- [ ] Sonner toasts used for all notifications
- [ ] Success actions show success toast
- [ ] Errors show descriptive error messages
- [ ] Loading states show toast.loading()

### Loading States
- [ ] Skeleton loaders shown during data fetch
- [ ] Buttons show loading state during submission
- [ ] Disabled state applied during async operations

### Error Handling
- [ ] Network errors caught and displayed
- [ ] User-friendly error messages (no stack traces)
- [ ] Fallback UI for error states
- [ ] No unhandled promise rejections

## Navigation

### Route Accessibility
- [ ] All pages have routes defined in router configuration
- [ ] Every page is accessible through navigation (menu, sidebar, or direct URL)
- [ ] Main pages (Dashboard, Home, Settings, etc.) accessible from primary navigation
- [ ] Secondary pages accessible through contextual navigation or direct links
- [ ] Deep-linked pages have breadcrumbs or back navigation
- [ ] 404/Not Found page implemented for invalid routes
- [ ] Protected routes have proper authentication checks
- [ ] Navigation state persists across page refreshes where appropriate

### Navigation UX
- [ ] Active route highlighted in navigation menu
- [ ] Clear visual hierarchy in navigation structure
- [ ] Mobile navigation is accessible and usable
- [ ] Navigation items have hover/focus states
- [ ] Nested routes show parent-child relationships
- [ ] User can always return to main areas (Dashboard/Home)

## Styling

### Tailwind CSS
- [ ] Tailwind v3 classes used
- [ ] HSL color variables from design system
- [ ] Custom CSS properties used where defined
- [ ] Responsive breakpoints: mobile-first approach
- [ ] Dark mode support via CSS variables

### Design System
- [ ] Colors use theme variables (primary, secondary, accent)
- [ ] Spacing uses Tailwind scale (p-4, gap-6, etc.)
- [ ] Border radius uses theme values (rounded-lg)
- [ ] Shadows use theme values (shadow-card)
- [ ] Typography follows Inter font system

## Accessibility

- [ ] Semantic HTML elements used
- [ ] Buttons have descriptive labels
- [ ] Forms have proper labels
- [ ] Focus states visible on interactive elements
- [ ] Color contrast meets WCAG standards

## Performance

- [ ] No console.log statements in production code
- [ ] No console errors in browser
- [ ] Images optimized (WebP, lazy loading)
- [ ] Large lists use virtualization if needed
- [ ] React Query cache configured appropriately

## Testing Readiness

- [ ] Components structured for easy testing
- [ ] Business logic separated from presentation
- [ ] Mock-friendly API layer
- [ ] No hardcoded values that should be configurable
- [ ] Environment variables properly configured

## Final Checks

- [ ] Code builds without errors (`npm run build`)
- [ ] Development server runs without errors (`npm run dev`)
- [ ] No TypeScript errors in editor
- [ ] Browser console is clean (no errors or warnings)
- [ ] All functionality works as expected
- [ ] Code follows existing project patterns
- [ ] Changes are consistent with the rest of the codebase



IMPORTANT: ALL styling and design decisions must follow the Design Reference section above EXACTLY. Do not make arbitrary design choices.

Analyze the existing project structure and implement the task following the patterns already established. Ensure all success criteria are met.