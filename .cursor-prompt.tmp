⚠️ CRITICAL EXECUTION RULES - READ FIRST ⚠️
❌ NEVER run: npm run dev, npm start, yarn dev, pnpm dev, or ANY development server
❌ NEVER run: long-running processes, servers, or commands that don't exit
❌ NEVER test the application by starting it
✅ ALLOWED: npm install, npm run build, npm run test (if needed)
✅ YOUR TASK: Create/modify files only, then STOP and EXIT immediately
⚠️ The MCP server handles all testing and validation separately

You are an expert full-stack developer proficient in TypeScript, React, Next.js, and modern UI/UX frameworks (Tailwind CSS, Shadcn UI, Radix UI).

=== DESIGN REFERENCE (MANDATORY) ===
# Modern Design Best Practices

## Philosophy

Create unique, memorable experiences while maintaining consistency through modern design principles. Every project should feel distinct yet professional, innovative yet intuitive.

---

## Landing Pages & Marketing Sites

### Hero Sections
**Go beyond static backgrounds:**
- Animated gradients with subtle movement
- Particle systems or geometric shapes floating
- Interactive canvas backgrounds (Three.js, WebGL)
- Video backgrounds with proper fallbacks
- Parallax scrolling effects
- Gradient mesh animations
- Morphing blob animations


### Layout Patterns
**Use modern grid systems:**
- Bento grids (asymmetric card layouts)
- Masonry layouts for varied content
- Feature sections with diagonal cuts or curves
- Overlapping elements with proper z-index
- Split-screen designs with scroll-triggered reveals

**Avoid:** Traditional 3-column equal grids

### Scroll Animations
**Engage users as they scroll:**
- Fade-in and slide-up animations for sections
- Scroll-triggered parallax effects
- Progress indicators for long pages
- Sticky elements that transform on scroll
- Horizontal scroll sections for portfolios
- Text reveal animations (word by word, letter by letter)
- Number counters animating into view

**Avoid:** Static pages with no scroll interaction

### Call-to-Action Areas
**Make CTAs impossible to miss:**
- Gradient buttons with hover effects
- Floating action buttons with micro-interactions
- Animated borders or glowing effects
- Scale/lift on hover
- Interactive elements that respond to mouse position
- Pulsing indicators for primary actions

---

## Dashboard Applications

### Layout Structure
**Always use collapsible side navigation:**
- Sidebar that can collapse to icons only
- Smooth transition animations between states
- Persistent navigation state (remember user preference)
- Mobile: drawer that slides in/out
- Desktop: sidebar with expand/collapse toggle
- Icons visible even when collapsed

**Structure:**
```
/dashboard (layout wrapper with sidebar)
  /dashboard/overview
  /dashboard/analytics
  /dashboard/settings
  /dashboard/users
  /dashboard/projects
```

All dashboard pages should be nested inside the dashboard layout, not separate routes.

### Data Tables
**Modern table design:**
- Sticky headers on scroll
- Row hover states with subtle elevation
- Sortable columns with clear indicators
- Pagination with items-per-page control
- Search/filter with instant feedback
- Selection checkboxes with bulk actions
- Responsive: cards on mobile, table on desktop
- Loading skeletons, not spinners
- Empty states with illustrations or helpful text

**Use modern table libraries:**
- TanStack Table (React Table v8)
- AG Grid for complex data
- Data Grid from MUI (if using MUI)

### Charts & Visualizations
**Use the latest charting libraries:**
- Recharts (for React, simple charts)
- Chart.js v4 (versatile, well-maintained)
- Apache ECharts (advanced, interactive)
- D3.js (custom, complex visualizations)
- Tremor (for dashboards, built on Recharts)

**Chart best practices:**
- Animated transitions when data changes
- Interactive tooltips with detailed info
- Responsive sizing
- Color scheme matching design system
- Legend placement that doesn't obstruct data
- Loading states while fetching data

### Dashboard Cards
**Metric cards should stand out:**
- Gradient backgrounds or colored accents
- Trend indicators (↑ ↓ with color coding)
- Sparkline charts for historical data
- Hover effects revealing more detail
- Icon representing the metric
- Comparison to previous period

---

## Color & Visual Design

### Color Palettes
**Create depth with gradients:**
- Primary gradient (not just solid primary color)
- Subtle background gradients
- Gradient text for headings
- Gradient borders on cards
- Elevated surfaces for depth

**Color usage:**
- 60-30-10 rule (dominant, secondary, accent)
- Consistent semantic colors (success, warning, error)
- Accessible contrast ratios (WCAG AA minimum)

### Typography
**Create hierarchy through contrast:**
- Large, bold headings (48-72px for heroes)
- Clear size differences between levels
- Variable font weights (300, 400, 600, 700)
- Letter spacing for small caps
- Line height 1.5-1.7 for body text
- Inter, Poppins, or DM Sans for modern feel

### Shadows & Depth
**Layer UI elements:**
- Multi-layer shadows for realistic depth
- Colored shadows matching element color
- Elevated states on hover
- Neumorphism for special elements (sparingly)

---

## Interactions & Micro-animations

### Button Interactions
**Every button should react:**
- Scale slightly on hover (1.02-1.05)
- Lift with shadow on hover
- Ripple effect on click
- Loading state with spinner or progress
- Disabled state clearly visible
- Success state with checkmark animation

### Card Interactions
**Make cards feel alive:**
- Lift on hover with increased shadow
- Subtle border glow on hover
- Tilt effect following mouse (3D transform)
- Smooth transitions (200-300ms)
- Click feedback for interactive cards

### Form Interactions
**Guide users through forms:**
- Input focus states with border color change
- Floating labels that animate up
- Real-time validation with inline messages
- Success checkmarks for valid inputs
- Error states with shake animation
- Password strength indicators
- Character count for text areas

### Page Transitions
**Smooth between views:**
- Fade + slide for page changes
- Skeleton loaders during data fetch
- Optimistic UI updates
- Stagger animations for lists
- Route transition animations

---

## Mobile Responsiveness

### Mobile-First Approach
**Design for mobile, enhance for desktop:**
- Touch targets minimum 44x44px
- Generous padding and spacing
- Sticky bottom navigation on mobile
- Collapsible sections for long content
- Swipeable cards and galleries
- Pull-to-refresh where appropriate

### Responsive Patterns
**Adapt layouts intelligently:**
- Hamburger menu → full nav bar
- Card grid → stack on mobile
- Sidebar → drawer
- Multi-column → single column
- Data tables → card list
- Hide/show elements based on viewport

---

## Loading & Empty States

### Loading States
**Never leave users wondering:**
- Skeleton screens matching content layout
- Progress bars for known durations
- Animated placeholders
- Spinners only for short waits (<3s)
- Stagger loading for multiple elements
- Shimmer effects on skeletons

### Empty States
**Make empty states helpful:**
- Illustrations or icons
- Helpful copy explaining why it's empty
- Clear CTA to add first item
- Examples or suggestions
- No "no data" text alone

---

## Unique Elements to Stand Out

### Distinctive Features
**Add personality:**
- Custom cursor effects on landing pages
- Animated page numbers or section indicators
- Unusual hover effects (magnification, distortion)
- Custom scrollbars
- Glassmorphism for overlays
- Animated SVG icons
- Typewriter effects for hero text
- Confetti or celebration animations for actions

### Interactive Elements
**Engage users:**
- Drag-and-drop interfaces
- Sliders and range controls
- Toggle switches with animations
- Progress steps with animations
- Expandable/collapsible sections
- Tabs with slide indicators
- Image comparison sliders
- Interactive demos or playgrounds

---

## Consistency Rules

### Maintain Consistency
**What should stay consistent:**
- Spacing scale (4px, 8px, 16px, 24px, 32px, 48px, 64px)
- Border radius values
- Animation timing (200ms, 300ms, 500ms)
- Color system (primary, secondary, accent, neutrals)
- Typography scale
- Icon style (outline vs filled)
- Button styles across the app
- Form element styles

### What Can Vary
**Project-specific customization:**
- Color palette (different colors, same system)
- Layout creativity (grids, asymmetry)
- Illustration style
- Animation personality
- Feature-specific interactions
- Hero section design
- Card styling variations
- Background patterns or textures

---

## Technical Excellence

### Performance
- Optimize images (WebP, lazy loading)
- Code splitting for faster loads
- Debounce search inputs
- Virtualize long lists
- Minimize re-renders
- Use proper memoization

### Accessibility
- Keyboard navigation throughout
- ARIA labels where needed
- Focus indicators visible
- Screen reader friendly
- Sufficient color contrast
- Respect reduced motion preferences

---

## Key Principles

1. **Be Bold** - Don't be afraid to try unique layouts and interactions
2. **Be Consistent** - Use the same patterns for similar functions
3. **Be Responsive** - Design works beautifully on all devices
4. **Be Fast** - Animations are smooth, loading is quick
5. **Be Accessible** - Everyone can use what you build
6. **Be Modern** - Use current design trends and technologies
7. **Be Unique** - Each project should have its own personality
8. **Be Intuitive** - Users shouldn't need instructions


---

# Project-Specific Customizations

**IMPORTANT: This section contains the specific design requirements for THIS project. The guidelines above are universal best practices - these customizations below take precedence for project-specific decisions.**

## User Design Requirements

- Ensure all skeletons use the same color families and shimmer treatment as other components.
- Maintain glassy, calm aesthetics with soft shadows, rounded corners, and ample white space.
- Use the accent colors for progress/status cues only when appropriate within skeletons (e.g., a fake progress bar color might reflect the in-progress yellow/orange palette).
- Keep interactions subtle; avoid distracting animations beyond the shimmer.

---

## Visual Style (Recap)

Color Palette:
- Primary: #FFFFFF
- Secondary: #F5F6FA, #F7F8FA
- Accent: #195C4A (deep green), #7BE495 (bright green), #FFE8A3 (soft yellow), #FFDCA8 (muted orange), #FF6C6C (light red)
- Text: #23272F (dark gray), #6B7280 (medium gray)
- Subtle shadows/borders: #E6E8F0, #D1D5DB

Typography & Layout:
- Font: Inter / SF Pro / Manrope family
- Weights: 400, 500, 600
- Layout: 24-32px container padding, 16-24px gaps, 8px increments
- Card Design: White background, shadows, 12-16px radius, generous internal padding (≥24px)

Key Design Elements:
- Card, Navigation, Data Visualization, Interactive Elements, Micro-interactions
- Focus on clarity, accessibility, mobile-first, and trust-building visuals

---

Generate the complete, detailed prompt now:
- Provide structured sections as above.
- Include explicit prop definitions, example usage snippets, and recommended test cases.
- Include implementation notes that a developer can directly translate into code or a tool-driven build.

## Implementation Notes

When implementing this project:

1. **Follow Universal Guidelines**: Use the design best practices documented above as your foundation
2. **Apply Project Customizations**: Implement the specific design requirements stated in the "User Design Requirements" section
3. **Priority Order**: Project-specific requirements override universal guidelines when there's a conflict
4. **Color System**: Extract and implement color values as CSS custom properties in RGB format
5. **Typography**: Define font families, sizes, and weights based on specifications
6. **Spacing**: Establish consistent spacing scale following the design system
7. **Components**: Style all Shadcn components to match the design aesthetic
8. **Animations**: Use Motion library for transitions matching the design personality
9. **Responsive Design**: Ensure mobile-first responsive implementation

## Implementation Checklist

- [ ] Review universal design guidelines above
- [ ] Extract project-specific color palette and define CSS variables
- [ ] Configure Tailwind theme with custom colors
- [ ] Set up typography system (fonts, sizes, weights)
- [ ] Define spacing and sizing scales
- [ ] Create component variants matching design
- [ ] Implement responsive breakpoints
- [ ] Add animations and transitions
- [ ] Ensure accessibility standards
- [ ] Validate against user design requirements

---

**Remember: Always reference this file for design decisions. Do not use generic or placeholder designs.**


*IMPORTANT*: For every page or component refer to # Modern Design Best Practices

## Philosophy

Create unique, memorable experiences while maintaining consistency through modern design principles. Every project should feel distinct yet professional, innovative yet intuitive.

---

## Landing Pages & Marketing Sites

### Hero Sections
**Go beyond static backgrounds:**
- Animated gradients with subtle movement
- Particle systems or geometric shapes floating
- Interactive canvas backgrounds (Three.js, WebGL)
- Video backgrounds with proper fallbacks
- Parallax scrolling effects
- Gradient mesh animations
- Morphing blob animations


### Layout Patterns
**Use modern grid systems:**
- Bento grids (asymmetric card layouts)
- Masonry layouts for varied content
- Feature sections with diagonal cuts or curves
- Overlapping elements with proper z-index
- Split-screen designs with scroll-triggered reveals

**Avoid:** Traditional 3-column equal grids

### Scroll Animations
**Engage users as they scroll:**
- Fade-in and slide-up animations for sections
- Scroll-triggered parallax effects
- Progress indicators for long pages
- Sticky elements that transform on scroll
- Horizontal scroll sections for portfolios
- Text reveal animations (word by word, letter by letter)
- Number counters animating into view

**Avoid:** Static pages with no scroll interaction

### Call-to-Action Areas
**Make CTAs impossible to miss:**
- Gradient buttons with hover effects
- Floating action buttons with micro-interactions
- Animated borders or glowing effects
- Scale/lift on hover
- Interactive elements that respond to mouse position
- Pulsing indicators for primary actions

---

## Dashboard Applications

### Layout Structure
**Always use collapsible side navigation:**
- Sidebar that can collapse to icons only
- Smooth transition animations between states
- Persistent navigation state (remember user preference)
- Mobile: drawer that slides in/out
- Desktop: sidebar with expand/collapse toggle
- Icons visible even when collapsed

**Structure:**
```
/dashboard (layout wrapper with sidebar)
  /dashboard/overview
  /dashboard/analytics
  /dashboard/settings
  /dashboard/users
  /dashboard/projects
```

All dashboard pages should be nested inside the dashboard layout, not separate routes.

### Data Tables
**Modern table design:**
- Sticky headers on scroll
- Row hover states with subtle elevation
- Sortable columns with clear indicators
- Pagination with items-per-page control
- Search/filter with instant feedback
- Selection checkboxes with bulk actions
- Responsive: cards on mobile, table on desktop
- Loading skeletons, not spinners
- Empty states with illustrations or helpful text

**Use modern table libraries:**
- TanStack Table (React Table v8)
- AG Grid for complex data
- Data Grid from MUI (if using MUI)

### Charts & Visualizations
**Use the latest charting libraries:**
- Recharts (for React, simple charts)
- Chart.js v4 (versatile, well-maintained)
- Apache ECharts (advanced, interactive)
- D3.js (custom, complex visualizations)
- Tremor (for dashboards, built on Recharts)

**Chart best practices:**
- Animated transitions when data changes
- Interactive tooltips with detailed info
- Responsive sizing
- Color scheme matching design system
- Legend placement that doesn't obstruct data
- Loading states while fetching data

### Dashboard Cards
**Metric cards should stand out:**
- Gradient backgrounds or colored accents
- Trend indicators (↑ ↓ with color coding)
- Sparkline charts for historical data
- Hover effects revealing more detail
- Icon representing the metric
- Comparison to previous period

---

## Color & Visual Design

### Color Palettes
**Create depth with gradients:**
- Primary gradient (not just solid primary color)
- Subtle background gradients
- Gradient text for headings
- Gradient borders on cards
- Elevated surfaces for depth

**Color usage:**
- 60-30-10 rule (dominant, secondary, accent)
- Consistent semantic colors (success, warning, error)
- Accessible contrast ratios (WCAG AA minimum)

### Typography
**Create hierarchy through contrast:**
- Large, bold headings (48-72px for heroes)
- Clear size differences between levels
- Variable font weights (300, 400, 600, 700)
- Letter spacing for small caps
- Line height 1.5-1.7 for body text
- Inter, Poppins, or DM Sans for modern feel

### Shadows & Depth
**Layer UI elements:**
- Multi-layer shadows for realistic depth
- Colored shadows matching element color
- Elevated states on hover
- Neumorphism for special elements (sparingly)

---

## Interactions & Micro-animations

### Button Interactions
**Every button should react:**
- Scale slightly on hover (1.02-1.05)
- Lift with shadow on hover
- Ripple effect on click
- Loading state with spinner or progress
- Disabled state clearly visible
- Success state with checkmark animation

### Card Interactions
**Make cards feel alive:**
- Lift on hover with increased shadow
- Subtle border glow on hover
- Tilt effect following mouse (3D transform)
- Smooth transitions (200-300ms)
- Click feedback for interactive cards

### Form Interactions
**Guide users through forms:**
- Input focus states with border color change
- Floating labels that animate up
- Real-time validation with inline messages
- Success checkmarks for valid inputs
- Error states with shake animation
- Password strength indicators
- Character count for text areas

### Page Transitions
**Smooth between views:**
- Fade + slide for page changes
- Skeleton loaders during data fetch
- Optimistic UI updates
- Stagger animations for lists
- Route transition animations

---

## Mobile Responsiveness

### Mobile-First Approach
**Design for mobile, enhance for desktop:**
- Touch targets minimum 44x44px
- Generous padding and spacing
- Sticky bottom navigation on mobile
- Collapsible sections for long content
- Swipeable cards and galleries
- Pull-to-refresh where appropriate

### Responsive Patterns
**Adapt layouts intelligently:**
- Hamburger menu → full nav bar
- Card grid → stack on mobile
- Sidebar → drawer
- Multi-column → single column
- Data tables → card list
- Hide/show elements based on viewport

---

## Loading & Empty States

### Loading States
**Never leave users wondering:**
- Skeleton screens matching content layout
- Progress bars for known durations
- Animated placeholders
- Spinners only for short waits (<3s)
- Stagger loading for multiple elements
- Shimmer effects on skeletons

### Empty States
**Make empty states helpful:**
- Illustrations or icons
- Helpful copy explaining why it's empty
- Clear CTA to add first item
- Examples or suggestions
- No "no data" text alone

---

## Unique Elements to Stand Out

### Distinctive Features
**Add personality:**
- Custom cursor effects on landing pages
- Animated page numbers or section indicators
- Unusual hover effects (magnification, distortion)
- Custom scrollbars
- Glassmorphism for overlays
- Animated SVG icons
- Typewriter effects for hero text
- Confetti or celebration animations for actions

### Interactive Elements
**Engage users:**
- Drag-and-drop interfaces
- Sliders and range controls
- Toggle switches with animations
- Progress steps with animations
- Expandable/collapsible sections
- Tabs with slide indicators
- Image comparison sliders
- Interactive demos or playgrounds

---

## Consistency Rules

### Maintain Consistency
**What should stay consistent:**
- Spacing scale (4px, 8px, 16px, 24px, 32px, 48px, 64px)
- Border radius values
- Animation timing (200ms, 300ms, 500ms)
- Color system (primary, secondary, accent, neutrals)
- Typography scale
- Icon style (outline vs filled)
- Button styles across the app
- Form element styles

### What Can Vary
**Project-specific customization:**
- Color palette (different colors, same system)
- Layout creativity (grids, asymmetry)
- Illustration style
- Animation personality
- Feature-specific interactions
- Hero section design
- Card styling variations
- Background patterns or textures

---

## Technical Excellence

### Performance
- Optimize images (WebP, lazy loading)
- Code splitting for faster loads
- Debounce search inputs
- Virtualize long lists
- Minimize re-renders
- Use proper memoization

### Accessibility
- Keyboard navigation throughout
- ARIA labels where needed
- Focus indicators visible
- Screen reader friendly
- Sufficient color contrast
- Respect reduced motion preferences

---

## Key Principles

1. **Be Bold** - Don't be afraid to try unique layouts and interactions
2. **Be Consistent** - Use the same patterns for similar functions
3. **Be Responsive** - Design works beautifully on all devices
4. **Be Fast** - Animations are smooth, loading is quick
5. **Be Accessible** - Everyone can use what you build
6. **Be Modern** - Use current design trends and technologies
7. **Be Unique** - Each project should have its own personality
8. **Be Intuitive** - Users shouldn't need instructions


---

# Project-Specific Customizations

**IMPORTANT: This section contains the specific design requirements for THIS project. The guidelines above are universal best practices - these customizations below take precedence for project-specific decisions.**

## User Design Requirements

- Ensure all skeletons use the same color families and shimmer treatment as other components.
- Maintain glassy, calm aesthetics with soft shadows, rounded corners, and ample white space.
- Use the accent colors for progress/status cues only when appropriate within skeletons (e.g., a fake progress bar color might reflect the in-progress yellow/orange palette).
- Keep interactions subtle; avoid distracting animations beyond the shimmer.

---

## Visual Style (Recap)

Color Palette:
- Primary: #FFFFFF
- Secondary: #F5F6FA, #F7F8FA
- Accent: #195C4A (deep green), #7BE495 (bright green), #FFE8A3 (soft yellow), #FFDCA8 (muted orange), #FF6C6C (light red)
- Text: #23272F (dark gray), #6B7280 (medium gray)
- Subtle shadows/borders: #E6E8F0, #D1D5DB

Typography & Layout:
- Font: Inter / SF Pro / Manrope family
- Weights: 400, 500, 600
- Layout: 24-32px container padding, 16-24px gaps, 8px increments
- Card Design: White background, shadows, 12-16px radius, generous internal padding (≥24px)

Key Design Elements:
- Card, Navigation, Data Visualization, Interactive Elements, Micro-interactions
- Focus on clarity, accessibility, mobile-first, and trust-building visuals

---

Generate the complete, detailed prompt now:
- Provide structured sections as above.
- Include explicit prop definitions, example usage snippets, and recommended test cases.
- Include implementation notes that a developer can directly translate into code or a tool-driven build.

## Implementation Notes

When implementing this project:

1. **Follow Universal Guidelines**: Use the design best practices documented above as your foundation
2. **Apply Project Customizations**: Implement the specific design requirements stated in the "User Design Requirements" section
3. **Priority Order**: Project-specific requirements override universal guidelines when there's a conflict
4. **Color System**: Extract and implement color values as CSS custom properties in RGB format
5. **Typography**: Define font families, sizes, and weights based on specifications
6. **Spacing**: Establish consistent spacing scale following the design system
7. **Components**: Style all Shadcn components to match the design aesthetic
8. **Animations**: Use Motion library for transitions matching the design personality
9. **Responsive Design**: Ensure mobile-first responsive implementation

## Implementation Checklist

- [ ] Review universal design guidelines above
- [ ] Extract project-specific color palette and define CSS variables
- [ ] Configure Tailwind theme with custom colors
- [ ] Set up typography system (fonts, sizes, weights)
- [ ] Define spacing and sizing scales
- [ ] Create component variants matching design
- [ ] Implement responsive breakpoints
- [ ] Add animations and transitions
- [ ] Ensure accessibility standards
- [ ] Validate against user design requirements

---

**Remember: Always reference this file for design decisions. Do not use generic or placeholder designs.**
 for bestpractices and # Visual Side-by-Side Comparison Viewer

## Overview
Develop a high-performance, visually rich, interactive Visual Side-by-Side Comparison Viewer integrated into Archject. This feature enables users to compare design options side-by-side with deep-zoom image viewing (BIM/CAD previews via Autodesk Forge), pan and zoom, annotations, mobile swipe support, and secure, permission-aware storage of annotations linked to decisions and files. The viewer must support progressive loading, thumbnail placeholders for large assets, and responsive behavior (desktop side-by-side; mobile stacked with swipe). It ties into three pages in the project: Client Portal (No-login Link), Decision Detail (Internal), and Create/Edit Decision Page.

---

## Components to Build

- Visual Side-by-Side Viewer (Core Component)
  - Deep-zoom image viewer using OpenSeadragon or equivalent
  - Side-by-side panes with synchronized navigation, pan, and zoom
  - Annotations layer (markers, shapes, freehand) with per-annotation metadata (text, user, timestamp)
  - Mobile-friendly swipe navigation between options; pinch-to-zoom and pan support
  - Progressive loading: show low-res placeholders, fetch high-res tiles on demand
  - Support for image-based options and document previews (e.g., PDFs) as tiled assets
  - Annotation persistence: save/load annotations per decision and per asset
  - Permission checks: read/write access based on user role and decision state
  - Export/share: generate a compact export including images, annotations, and metadata

- Autodesk Forge BIM/CAD Preview Integration
  - In-browser model viewing for IFC, RVT, DWG via Forge viewer
  - Secure token-based access to Forge assets
  - Simple overlays/markup support within Forge viewer
  - Supports deep-zoom-like navigation and pan/zoom within Forge viewer
  - Progressive loading for large BIM files
  - Annotations stored and linked to specific files and decisions

- Client Portal (No-login Link)
  - Lightweight, branded portion with no login required
  - Secure, signed URL tokens for no-login access
  - Visual Side-by-Side viewer embedded for clients to review options
  - Commenting on individual options or annotations (offline-friendly)
  - Approve / Request Changes actions with timestamped history
  - Optional email capture and OTP verification for identity confirmation
  - Branding, terms, privacy notice, and accessibility considerations

- Decision Detail (Internal)
  - Comprehensive decision view for internal users
  - Display decision metadata, all options, and side-by-side comparison view
  - Annotations, comments, and admin actions (edit decision, revoke approval, export decision log)
  - Approval history timeline with user roles and timestamps
  - Admin actions with permission checks and audit logging
  - Export formats: PDF/CSV/JSON of decision with options and annotations

- Create / Edit Decision Page
  - Multi-step editor (wizard-style)
  - Metadata: title, project, client, due date, status, tags
  - Options upload: images, spec sheets, layouts, and optional BIM/CAD assets
  - Side-by-Side setup: number of options, layout configuration (2-up, 3-up, adaptive)
  - Approval rules: who can approve, required approvals, escalation
  - Assignee selection and role-based permissions
  - Schedule reminders (email/SMS) with recurrence
  - Validation for uploads, file types, sizes, and required fields
  - Auto-save / draft state with versioning

---

## Implementation Requirements

### Frontend
- Frameworks: React (Vue/Angular optional if specified by team), TypeScript
- Core UI: Reusable components adhering to the Archject design system
  - Card, Button (primary/secondary), Tabs, Drawer/Sidebar, Toolbar, Badge, Tag
  - Forms: Input, Textarea, Select, File Upload with drag-and-drop, Date/Time pickers
  - Chessboard-like layout for side-by-side viewer with responsive breakpoints
- Visual Side-by-Side Viewer
  - Two up to four up responsive layout
  - OpenSeadragon-based deep-zoom viewer for each pane
  - Forge Viewer integration for BIM/CAD previews
  - Annotation overlays as vector layers (SVG or canvas) with:
    - Text notes, shapes (rectangles, polygons), freehand
    - Metadata: author, timestamp, annotation type, associated asset/file
    - Ability to edit/delete annotations
  - Sync controls: zoom/pan sync toggle, per-pane zoom lock
  - Navigation: thumbnail strip, prefetching, lazy loading
  - Interaction patterns:
    - Pan/Zoom with mouse, touch, and trackpad
    - Pinch-to-zoom on mobile
    - Double-tap to reset zoom
    - Long-press to create annotation (mobile)
  - Accessibility: ARIA roles, keyboard navigation (arrow keys to pan, +/- to zoom)
- Authentication/Authorization on UI
  - State-driven UI based on user role (Client, Internal, Admin)
  - Show/hide actions (Approve, Request Changes, Edit, Export) accordingly
- API Integration Layer
  - REST or GraphQL client to fetch decision data, options, and annotations
  - WebSocket or SSE for real-time updates if feasible
  - Token-based access for Forge assets
- Performance
  - Virtualized lists for option thumbnails
  - Debounced saves for annotations
  - Efficient image tiling and caching
  - Lazy loading of Forge assets
- Mobile UX
  - Responsive grid, stacked view on small screens
  - Large tap targets, swipe-to-switch between options
  - Accessible high-contrast controls
- Data Persistence (Frontend)
  - Local state store (Redux/Context) with persistence for unsaved changes
  - Sync state against backend on save/publish actions

### Backend
- Data Models
  - Decision: id, projectId, title, status, clientId (optional), dueDate, createdBy, updatedAt, history
  - Option: id, decisionId, title, description, assets: [Asset], order, createdBy, thumbnails, previews
  - Asset: id, decisionId, optionId, type (image, BIM, PDF, CAD), url, fileName, size, iframePreviewUrl, forgeAssetId (optional)
  - Annotation: id, decisionId, optionId, assetId, type (text, shape, freehand), data (JSON with coordinates, color, stroke), authorId, createdAt, updatedAt
  - ForgeAssetAccess: assetId, forgeToken, expiry
  - ApprovalHistory: id, decisionId, action, performedBy, timestamp, notes
  - User: id, name, email, role (Client, Internal, Admin, Assignee)
  - Reminder: id, decisionId, dueDate, method (email/SMS), message, sent
  - PermissionScheme: role, permissions
- API Endpoints (REST)
  - GET /decisions/{decisionId} -> Decision with options, annotations, history
  - POST /decisions -> Create Decision (multi-step hints enforced)
  - PUT /decisions/{id} -> Update decision metadata
  - GET /decisions/{decisionId}/options -> Fetch options
  - POST /decisions/{decisionId}/options/{optionId}/annotations -> Create annotation
  - GET /annotations/{annotationId} -> Fetch annotation
  - PUT /annotations/{annotationId} -> Update annotation
  - DELETE /annotations/{annotationId} -> Delete annotation
  - POST /decisions/{decisionId}/approve -> Approve decision
  - POST /decisions/{decisionId}/request-changes -> Request changes
  - POST /decisions/{decisionId}/export -> Export decision log (PDF/CSV/JSON)
  - POST /forge/token -> Acquire Forge access token for asset previews
  - GET /assets/{assetId}/preview -> Asset preview URL (image, PDF, BIM)
  - POST /clients/validate-otp -> OTP verification for no-login portal
  - POST /reminders -> Schedule reminder
  - POST /decisions/{decisionId}/publish -> Publish decision (if in draft)
- Database Tables
  - Decisions, Options, Assets, Annotations, Users, Approvals, Reminders, History, ForgeTokens, Files, Projects
- Background Jobs
  - Generate PDF/CSV exports
  - Preload Forge asset metadata and tokens
  - Notify clients/internal users on state changes
  - Cleanup expired Forge tokens

### Integration
- Forge Viewer Integration
  - Forge Viewer SDK initialization and token management
  - Asset mapping: assets linked to options renderable in Forge or as separate image previews
  - Annotations overlay persistence in backend per asset
- OpenSeadragon Integration
  - Tile source setup for each asset
  - Cross-pane synchronization (optional)
  - Annotations rendered on top of viewer overlays
- Client Portal Integration
  - No-login flow guarded by signed URLs or time-limited tokens
  - OTP option with email validation
  - Client-side comment capabilities and approval actions
- Decision Detail / Admin Flows
  - Full audit trail visible
  - Exportable decision logs
  - Admin actions with authorization checks
- Create/Edit Decision Page
  - Multi-step wizard with step validation
  - Uploads processed and stored
  - Side-by-side viewer configuration per decision
  - Reminder scheduling and assignee assignment

---

## User Experience Flow

1) Create Decision (Internal)
- User navigates to Create Decision Page
- Fill metadata (title, project, due date, client, status)
- Upload options (images, specs, layouts, BIM/CAD assets)
- Configure side-by-side viewer (which options are shown, layout 2-up/3-up, initialization)
- Set approval rules, assign a lead, and configure reminders
- Save draft or Publish
- On publish, an initial decision log is created; internal users can see in Decision Detail

2) Decision Detail (Internal)
- Open a decision, view metadata, options, and the side-by-side viewer
- Inspect assets: images, BIM/CAD previews via Forge, PDFs
- Add annotations to any asset/option; annotations saved with author and timestamp
- Review comments, approval history, and perform admin actions (edit, revoke approval, export)
- Send reminders to assignees or clients if needed

3) Client Portal (No-login Link)
- Client accesses a branded, no-login URL
- Side-by-side viewer loads with accessible assets
- Client can add comments per option or global, and mark approval or request changes
- Optional OTP/email verification can be enabled to validate identity
- Decision state updates in real-time (if enabled) and client receives status cues

4) Publisher/Export
- Admin exports a decision log (PDF/CSV/JSON) including options, annotations, and approval history
- Exports can be attached to project documentation or contracts

5) Mobile Experience
- On small screens, viewer stacks vertically with swipe between options
- Deep-zoom remains usable with touch gestures
- Annotations are accessible and creatable via touch

---

## Technical Specifications

### Data Models
- Decision: id, projectId, title, status, clientId, dueDate, createdBy, updatedAt
- Option: id, decisionId, title, description, order, assets: [Asset]
- Asset: id, optionId, decisionId, type (image, BIM, PDF, CAD), url, thumbnailUrl, size, metadata
- Annotation: id, decisionId, optionId, assetId, type (text|shape|freehand), data(JSON: coordinates, color, stroke, text, font), authorId, createdAt, updatedAt
- ForgeToken: id, assetId, token, expiry
- ApprovalHistory: id, decisionId, action (approve/reject/edit/export), performedBy, timestamp, notes
- Reminder: id, decisionId, dueDate, method, message, status
- User: id, name, email, role (Client|Internal|Admin|Assignee)
- AccessLog: id, decisionId, viewerId, timestamp, action
- FileUpload: id, decisionId, optionId, assetId, filename, mimeType, size, uploadDate

### API Endpoints (RESTful)
- GET /decisions/{decisionId}
- POST /decisions
- PUT /decisions/{decisionId}
- DELETE /decisions/{decisionId}
- GET /decisions/{decisionId}/options
- POST /decisions/{decisionId}/options
- PUT /decisions/{decisionId}/options/{optionId}
- GET /decisions/{decisionId}/annotations
- POST /decisions/{decisionId}/annotations
- PUT /annotations/{annotationId}
- DELETE /annotations/{annotationId}
- POST /decisions/{decisionId}/approve
- POST /decisions/{decisionId}/request-changes
- POST /decisions/{decisionId}/export
- POST /forge/token
- GET /assets/{assetId}/preview
- POST /clients/validate-otp
- POST /reminders
- POST /decisions/{decisionId}/publish
- POST /decisions/{decisionId}/annotations/{annotationId}/link-asset
- GET /users/me

### Security
- Authentication: JWT/OAuth2 with access tokens; role-based access control (RABC)
- No-login portal: time-limited signed URLs or one-time tokens; OTP optional
- Permissions:
  - Client: view with comments; approve/reject if allowed by policy
  - Internal: view/edit; manage assets, annotations, approvals
  - Admin: all actions including export, user management
- Data protection: TLS in transit; encryption at rest for sensitive data; audit logging for all write actions
- Forge access: short-lived tokens; scoped access per asset; revocation support

### Validation
- File uploads: allowed MIME types, max size per asset, virus/malware scanning integration
- Required fields: decision title, at least one option, assets per option
- Annotations: valid geometry coordinates; non-empty text if type=text
- OTP verification: 6-digit code; rate limiting
- Access control: deny actions that exceed user role permissions

---

## Acceptance Criteria

- [ ] Visual Side-by-Side Viewer renders two or more options with synchronized zoom/pan; deep-zoom tiles load progressively and gracefully degrade to lower resolution while loading higher tiles
- [ ] Forge BIM/CAD previews load in-browser with responsive controls; annotation overlay supports adding/updating/deleting annotations
- [ ] Completed annotations persist to backend and are linked to the correct decision, option, and asset; permission checks enforce read/write accessibility
- [ ] Client Portal provides a no-login review link with optional OTP verification; clients can comment and approve or request changes; branding matches the design system
- [ ] Decision Detail shows full decision metadata, all options, side-by-side comparison, annotations, approval history, and admin actions; export generates PDF/CSV/JSON
- [ ] Create/Edit Decision Page workflow validates inputs, supports multi-step wizard, handles asset uploads, and saves drafts with versioning
- [ ] Accessibility: keyboard navigation, screen-reader friendly, sufficient color contrast per design system
- [ ] Performance: page load times under 2s for initial render on average connections; smooth client-side interaction on mid-range devices
- [ ] Security: all endpoints protected by RBAC; no-login flow is tokenized and expirable; Forge tokens rotated and scoped

---

## UI/UX Guidelines

- Follow the Archject design system exactly:
  - Cards with white background, soft shadows, 12–16 px radii
  - Primary action color: Deep green (#195C4A)
  - Secondary actions: lighter backgrounds with hover elevations
  - Status indicators: green/yellow/orange/red tags with bold text
  - Typography: Inter/Manrope-family; weights 400/500/600; strong visual hierarchy
  - Spacing: 24–32 px container padding; 16–24 px between components; 8 px increments
  - Data visuals: clean charts with minimal grid lines; subtle shadows for containers
  - Mobile-first: touch targets ≥ 44x44 px; responsive stacking
- Ensure consistent branding across Client Portal, Internal Decision Detail, and Create/Edit Decision pages
- Provide clear affordances for annotations, including color-coding by user or type
- Ensure easy export/share workflows and clear audit trails

---

## Visual Style

- Color Palette (as provided in the prompt)
  - Primary: #FFFFFF
  - Secondary: #F5F6FA, #F7F8FA
  - Accent: #195C4A (active nav, primary actions), #7BE495 (success), #FFE8A3 (warning), #FFDCA8 (in-progress), #FF6C6C (destructive)
  - Text: #23272F (headings), #6B7280 (muted)
  - Shadows: rgba(34, 42, 89, 0.05)
- Typography and Layout as described
- Card, Navigation, Data Visualization, and Interactive Element guidelines

---

## Connected Pages and APIs
- Client Portal (No-login Link): build the no-login flow with OTP option; embed Visual Side-by-Side Viewer
- Decision Detail (Internal): full internal view with admin controls and export
- Create / Edit Decision Page: multi-step editor with asset uploads and viewer configuration
- Autodesk Forge (BIM/CAD Viewing): Forge Viewer integration for preview and simple markup
- Backend APIs: decisions, options, assets, annotations, approvals, reminders, exports
- Security: tokenized access for no-login; RBAC for internal/admin

---

## Deliverables

- Full-source code with:
  - Frontend: React components, OpenSeadragon integration, Forge Viewer integration, annotation layer, responsive layout, no-login flow
  - Backend: REST/GraphQL API definitions, data models, migrations, seed data, auth/authorization logic, Forge token management
  - Database schema and migrations
  - Documentation: setup, run instructions, API contracts, data models, and deployment notes
  - Tests: unit/integration tests for viewer interactions, API endpoints, and permission checks
  - CI/CD: build pipelines, linting, type checks, tests, deployment steps
- Design assets: component library usage details, spacing grid, and responsive behavior specs
- Accessibility report: keyboard navigation, ARIA labeling, color contrast checks

---

If you need this prompt tailored to a specific tech stack (e.g., Next.js vs. Remix, PostgreSQL vs. MongoDB, cloud provider, or a particular design system library), specify constraints and I can adjust the prompt accordingly. for style.

CRITICAL DESIGN REQUIREMENTS:
- You MUST follow ALL design principles and patterns specified in the Design Reference above
- Do NOT deviate from the design specifications without explicit user permission
- Implement ALL visual design elements (colors, typography, spacing, shadows, animations) as specified
- Follow the layout patterns and component designs exactly as documented
- Ensure all interactions and micro-animations match the reference specifications

CRITICAL TECHNICAL REQUIREMENTS:
- React 18.3.1, React Router 6.30.1
- Tailwind CSS v3 with tailwind.config.js and custom keyframes
- @tailwindcss/typography plugin for rich text content
- Tailwind CSS animations (NOT Motion library or framer-motion)
- Sonner for toasts
- Recharts for data visualization
- Native fetch() with API utilities in src/lib/api.ts
- Design system with CSS custom properties
- Use RGB color values for theming
- When Supabase is configured: use Edge Functions for LLM and server-only logic; never expose API keys in the client

=== TASK ===
# Visual Side-by-Side Comparison Viewer

## Overview
Develop a high-performance, visually rich, interactive Visual Side-by-Side Comparison Viewer integrated into Archject. This feature enables users to compare design options side-by-side with deep-zoom image viewing (BIM/CAD previews via Autodesk Forge), pan and zoom, annotations, mobile swipe support, and secure, permission-aware storage of annotations linked to decisions and files. The viewer must support progressive loading, thumbnail placeholders for large assets, and responsive behavior (desktop side-by-side; mobile stacked with swipe). It ties into three pages in the project: Client Portal (No-login Link), Decision Detail (Internal), and Create/Edit Decision Page.

---

## Components to Build

- Visual Side-by-Side Viewer (Core Component)
  - Deep-zoom image viewer using OpenSeadragon or equivalent
  - Side-by-side panes with synchronized navigation, pan, and zoom
  - Annotations layer (markers, shapes, freehand) with per-annotation metadata (text, user, timestamp)
  - Mobile-friendly swipe navigation between options; pinch-to-zoom and pan support
  - Progressive loading: show low-res placeholders, fetch high-res tiles on demand
  - Support for image-based options and document previews (e.g., PDFs) as tiled assets
  - Annotation persistence: save/load annotations per decision and per asset
  - Permission checks: read/write access based on user role and decision state
  - Export/share: generate a compact export including images, annotations, and metadata

- Autodesk Forge BIM/CAD Preview Integration
  - In-browser model viewing for IFC, RVT, DWG via Forge viewer
  - Secure token-based access to Forge assets
  - Simple overlays/markup support within Forge viewer
  - Supports deep-zoom-like navigation and pan/zoom within Forge viewer
  - Progressive loading for large BIM files
  - Annotations stored and linked to specific files and decisions

- Client Portal (No-login Link)
  - Lightweight, branded portion with no login required
  - Secure, signed URL tokens for no-login access
  - Visual Side-by-Side viewer embedded for clients to review options
  - Commenting on individual options or annotations (offline-friendly)
  - Approve / Request Changes actions with timestamped history
  - Optional email capture and OTP verification for identity confirmation
  - Branding, terms, privacy notice, and accessibility considerations

- Decision Detail (Internal)
  - Comprehensive decision view for internal users
  - Display decision metadata, all options, and side-by-side comparison view
  - Annotations, comments, and admin actions (edit decision, revoke approval, export decision log)
  - Approval history timeline with user roles and timestamps
  - Admin actions with permission checks and audit logging
  - Export formats: PDF/CSV/JSON of decision with options and annotations

- Create / Edit Decision Page
  - Multi-step editor (wizard-style)
  - Metadata: title, project, client, due date, status, tags
  - Options upload: images, spec sheets, layouts, and optional BIM/CAD assets
  - Side-by-Side setup: number of options, layout configuration (2-up, 3-up, adaptive)
  - Approval rules: who can approve, required approvals, escalation
  - Assignee selection and role-based permissions
  - Schedule reminders (email/SMS) with recurrence
  - Validation for uploads, file types, sizes, and required fields
  - Auto-save / draft state with versioning

---

## Implementation Requirements

### Frontend
- Frameworks: React (Vue/Angular optional if specified by team), TypeScript
- Core UI: Reusable components adhering to the Archject design system
  - Card, Button (primary/secondary), Tabs, Drawer/Sidebar, Toolbar, Badge, Tag
  - Forms: Input, Textarea, Select, File Upload with drag-and-drop, Date/Time pickers
  - Chessboard-like layout for side-by-side viewer with responsive breakpoints
- Visual Side-by-Side Viewer
  - Two up to four up responsive layout
  - OpenSeadragon-based deep-zoom viewer for each pane
  - Forge Viewer integration for BIM/CAD previews
  - Annotation overlays as vector layers (SVG or canvas) with:
    - Text notes, shapes (rectangles, polygons), freehand
    - Metadata: author, timestamp, annotation type, associated asset/file
    - Ability to edit/delete annotations
  - Sync controls: zoom/pan sync toggle, per-pane zoom lock
  - Navigation: thumbnail strip, prefetching, lazy loading
  - Interaction patterns:
    - Pan/Zoom with mouse, touch, and trackpad
    - Pinch-to-zoom on mobile
    - Double-tap to reset zoom
    - Long-press to create annotation (mobile)
  - Accessibility: ARIA roles, keyboard navigation (arrow keys to pan, +/- to zoom)
- Authentication/Authorization on UI
  - State-driven UI based on user role (Client, Internal, Admin)
  - Show/hide actions (Approve, Request Changes, Edit, Export) accordingly
- API Integration Layer
  - REST or GraphQL client to fetch decision data, options, and annotations
  - WebSocket or SSE for real-time updates if feasible
  - Token-based access for Forge assets
- Performance
  - Virtualized lists for option thumbnails
  - Debounced saves for annotations
  - Efficient image tiling and caching
  - Lazy loading of Forge assets
- Mobile UX
  - Responsive grid, stacked view on small screens
  - Large tap targets, swipe-to-switch between options
  - Accessible high-contrast controls
- Data Persistence (Frontend)
  - Local state store (Redux/Context) with persistence for unsaved changes
  - Sync state against backend on save/publish actions

### Backend
- Data Models
  - Decision: id, projectId, title, status, clientId (optional), dueDate, createdBy, updatedAt, history
  - Option: id, decisionId, title, description, assets: [Asset], order, createdBy, thumbnails, previews
  - Asset: id, decisionId, optionId, type (image, BIM, PDF, CAD), url, fileName, size, iframePreviewUrl, forgeAssetId (optional)
  - Annotation: id, decisionId, optionId, assetId, type (text, shape, freehand), data (JSON with coordinates, color, stroke), authorId, createdAt, updatedAt
  - ForgeAssetAccess: assetId, forgeToken, expiry
  - ApprovalHistory: id, decisionId, action, performedBy, timestamp, notes
  - User: id, name, email, role (Client, Internal, Admin, Assignee)
  - Reminder: id, decisionId, dueDate, method (email/SMS), message, sent
  - PermissionScheme: role, permissions
- API Endpoints (REST)
  - GET /decisions/{decisionId} -> Decision with options, annotations, history
  - POST /decisions -> Create Decision (multi-step hints enforced)
  - PUT /decisions/{id} -> Update decision metadata
  - GET /decisions/{decisionId}/options -> Fetch options
  - POST /decisions/{decisionId}/options/{optionId}/annotations -> Create annotation
  - GET /annotations/{annotationId} -> Fetch annotation
  - PUT /annotations/{annotationId} -> Update annotation
  - DELETE /annotations/{annotationId} -> Delete annotation
  - POST /decisions/{decisionId}/approve -> Approve decision
  - POST /decisions/{decisionId}/request-changes -> Request changes
  - POST /decisions/{decisionId}/export -> Export decision log (PDF/CSV/JSON)
  - POST /forge/token -> Acquire Forge access token for asset previews
  - GET /assets/{assetId}/preview -> Asset preview URL (image, PDF, BIM)
  - POST /clients/validate-otp -> OTP verification for no-login portal
  - POST /reminders -> Schedule reminder
  - POST /decisions/{decisionId}/publish -> Publish decision (if in draft)
- Database Tables
  - Decisions, Options, Assets, Annotations, Users, Approvals, Reminders, History, ForgeTokens, Files, Projects
- Background Jobs
  - Generate PDF/CSV exports
  - Preload Forge asset metadata and tokens
  - Notify clients/internal users on state changes
  - Cleanup expired Forge tokens

### Integration
- Forge Viewer Integration
  - Forge Viewer SDK initialization and token management
  - Asset mapping: assets linked to options renderable in Forge or as separate image previews
  - Annotations overlay persistence in backend per asset
- OpenSeadragon Integration
  - Tile source setup for each asset
  - Cross-pane synchronization (optional)
  - Annotations rendered on top of viewer overlays
- Client Portal Integration
  - No-login flow guarded by signed URLs or time-limited tokens
  - OTP option with email validation
  - Client-side comment capabilities and approval actions
- Decision Detail / Admin Flows
  - Full audit trail visible
  - Exportable decision logs
  - Admin actions with authorization checks
- Create/Edit Decision Page
  - Multi-step wizard with step validation
  - Uploads processed and stored
  - Side-by-side viewer configuration per decision
  - Reminder scheduling and assignee assignment

---

## User Experience Flow

1) Create Decision (Internal)
- User navigates to Create Decision Page
- Fill metadata (title, project, due date, client, status)
- Upload options (images, specs, layouts, BIM/CAD assets)
- Configure side-by-side viewer (which options are shown, layout 2-up/3-up, initialization)
- Set approval rules, assign a lead, and configure reminders
- Save draft or Publish
- On publish, an initial decision log is created; internal users can see in Decision Detail

2) Decision Detail (Internal)
- Open a decision, view metadata, options, and the side-by-side viewer
- Inspect assets: images, BIM/CAD previews via Forge, PDFs
- Add annotations to any asset/option; annotations saved with author and timestamp
- Review comments, approval history, and perform admin actions (edit, revoke approval, export)
- Send reminders to assignees or clients if needed

3) Client Portal (No-login Link)
- Client accesses a branded, no-login URL
- Side-by-side viewer loads with accessible assets
- Client can add comments per option or global, and mark approval or request changes
- Optional OTP/email verification can be enabled to validate identity
- Decision state updates in real-time (if enabled) and client receives status cues

4) Publisher/Export
- Admin exports a decision log (PDF/CSV/JSON) including options, annotations, and approval history
- Exports can be attached to project documentation or contracts

5) Mobile Experience
- On small screens, viewer stacks vertically with swipe between options
- Deep-zoom remains usable with touch gestures
- Annotations are accessible and creatable via touch

---

## Technical Specifications

### Data Models
- Decision: id, projectId, title, status, clientId, dueDate, createdBy, updatedAt
- Option: id, decisionId, title, description, order, assets: [Asset]
- Asset: id, optionId, decisionId, type (image, BIM, PDF, CAD), url, thumbnailUrl, size, metadata
- Annotation: id, decisionId, optionId, assetId, type (text|shape|freehand), data(JSON: coordinates, color, stroke, text, font), authorId, createdAt, updatedAt
- ForgeToken: id, assetId, token, expiry
- ApprovalHistory: id, decisionId, action (approve/reject/edit/export), performedBy, timestamp, notes
- Reminder: id, decisionId, dueDate, method, message, status
- User: id, name, email, role (Client|Internal|Admin|Assignee)
- AccessLog: id, decisionId, viewerId, timestamp, action
- FileUpload: id, decisionId, optionId, assetId, filename, mimeType, size, uploadDate

### API Endpoints (RESTful)
- GET /decisions/{decisionId}
- POST /decisions
- PUT /decisions/{decisionId}
- DELETE /decisions/{decisionId}
- GET /decisions/{decisionId}/options
- POST /decisions/{decisionId}/options
- PUT /decisions/{decisionId}/options/{optionId}
- GET /decisions/{decisionId}/annotations
- POST /decisions/{decisionId}/annotations
- PUT /annotations/{annotationId}
- DELETE /annotations/{annotationId}
- POST /decisions/{decisionId}/approve
- POST /decisions/{decisionId}/request-changes
- POST /decisions/{decisionId}/export
- POST /forge/token
- GET /assets/{assetId}/preview
- POST /clients/validate-otp
- POST /reminders
- POST /decisions/{decisionId}/publish
- POST /decisions/{decisionId}/annotations/{annotationId}/link-asset
- GET /users/me

### Security
- Authentication: JWT/OAuth2 with access tokens; role-based access control (RABC)
- No-login portal: time-limited signed URLs or one-time tokens; OTP optional
- Permissions:
  - Client: view with comments; approve/reject if allowed by policy
  - Internal: view/edit; manage assets, annotations, approvals
  - Admin: all actions including export, user management
- Data protection: TLS in transit; encryption at rest for sensitive data; audit logging for all write actions
- Forge access: short-lived tokens; scoped access per asset; revocation support

### Validation
- File uploads: allowed MIME types, max size per asset, virus/malware scanning integration
- Required fields: decision title, at least one option, assets per option
- Annotations: valid geometry coordinates; non-empty text if type=text
- OTP verification: 6-digit code; rate limiting
- Access control: deny actions that exceed user role permissions

---

## Acceptance Criteria

- [ ] Visual Side-by-Side Viewer renders two or more options with synchronized zoom/pan; deep-zoom tiles load progressively and gracefully degrade to lower resolution while loading higher tiles
- [ ] Forge BIM/CAD previews load in-browser with responsive controls; annotation overlay supports adding/updating/deleting annotations
- [ ] Completed annotations persist to backend and are linked to the correct decision, option, and asset; permission checks enforce read/write accessibility
- [ ] Client Portal provides a no-login review link with optional OTP verification; clients can comment and approve or request changes; branding matches the design system
- [ ] Decision Detail shows full decision metadata, all options, side-by-side comparison, annotations, approval history, and admin actions; export generates PDF/CSV/JSON
- [ ] Create/Edit Decision Page workflow validates inputs, supports multi-step wizard, handles asset uploads, and saves drafts with versioning
- [ ] Accessibility: keyboard navigation, screen-reader friendly, sufficient color contrast per design system
- [ ] Performance: page load times under 2s for initial render on average connections; smooth client-side interaction on mid-range devices
- [ ] Security: all endpoints protected by RBAC; no-login flow is tokenized and expirable; Forge tokens rotated and scoped

---

## UI/UX Guidelines

- Follow the Archject design system exactly:
  - Cards with white background, soft shadows, 12–16 px radii
  - Primary action color: Deep green (#195C4A)
  - Secondary actions: lighter backgrounds with hover elevations
  - Status indicators: green/yellow/orange/red tags with bold text
  - Typography: Inter/Manrope-family; weights 400/500/600; strong visual hierarchy
  - Spacing: 24–32 px container padding; 16–24 px between components; 8 px increments
  - Data visuals: clean charts with minimal grid lines; subtle shadows for containers
  - Mobile-first: touch targets ≥ 44x44 px; responsive stacking
- Ensure consistent branding across Client Portal, Internal Decision Detail, and Create/Edit Decision pages
- Provide clear affordances for annotations, including color-coding by user or type
- Ensure easy export/share workflows and clear audit trails

---

## Visual Style

- Color Palette (as provided in the prompt)
  - Primary: #FFFFFF
  - Secondary: #F5F6FA, #F7F8FA
  - Accent: #195C4A (active nav, primary actions), #7BE495 (success), #FFE8A3 (warning), #FFDCA8 (in-progress), #FF6C6C (destructive)
  - Text: #23272F (headings), #6B7280 (muted)
  - Shadows: rgba(34, 42, 89, 0.05)
- Typography and Layout as described
- Card, Navigation, Data Visualization, and Interactive Element guidelines

---

## Connected Pages and APIs
- Client Portal (No-login Link): build the no-login flow with OTP option; embed Visual Side-by-Side Viewer
- Decision Detail (Internal): full internal view with admin controls and export
- Create / Edit Decision Page: multi-step editor with asset uploads and viewer configuration
- Autodesk Forge (BIM/CAD Viewing): Forge Viewer integration for preview and simple markup
- Backend APIs: decisions, options, assets, annotations, approvals, reminders, exports
- Security: tokenized access for no-login; RBAC for internal/admin

---

## Deliverables

- Full-source code with:
  - Frontend: React components, OpenSeadragon integration, Forge Viewer integration, annotation layer, responsive layout, no-login flow
  - Backend: REST/GraphQL API definitions, data models, migrations, seed data, auth/authorization logic, Forge token management
  - Database schema and migrations
  - Documentation: setup, run instructions, API contracts, data models, and deployment notes
  - Tests: unit/integration tests for viewer interactions, API endpoints, and permission checks
  - CI/CD: build pipelines, linting, type checks, tests, deployment steps
- Design assets: component library usage details, spacing grid, and responsive behavior specs
- Accessibility report: keyboard navigation, ARIA labeling, color contrast checks

---

If you need this prompt tailored to a specific tech stack (e.g., Next.js vs. Remix, PostgreSQL vs. MongoDB, cloud provider, or a particular design system library), specify constraints and I can adjust the prompt accordingly.

=== SUCCESS CRITERIA ===
# Success Criteria Checklist

## Code Quality

### TypeScript
- [ ] No TypeScript errors (`tsc --noEmit` passes)
- [ ] All functions and components have proper type definitions
- [ ] No `any` types used (use `unknown` if type is truly unknown)
- [ ] Props interfaces defined for all components
- [ ] API responses have type definitions

### Code Standards
- [ ] All imports use path aliases (@/ prefix)
- [ ] Components follow the established naming convention
- [ ] Files are organized in correct directories
- [ ] No unused imports or variables
- [ ] Consistent code formatting

## Component Implementation

### UI Components
- [ ] Use shadcn/ui components (Button, Card, Input, etc.) instead of building from scratch
- [ ] All interactive elements have hover states
- [ ] Components use the `cn()` utility for class merging
- [ ] Proper TypeScript props interfaces defined
- [ ] Components are responsive (mobile, tablet, desktop)

### Animations
- [ ] Motion library used for all animations (NOT framer-motion)
- [ ] Page transitions implemented with fade/slide
- [ ] Interactive elements have whileHover/whileTap animations
- [ ] List items use stagger animations where appropriate
- [ ] Animations respect `prefers-reduced-motion`

### Icons
- [ ] Lucide React icons used consistently
- [ ] Icons have consistent sizing (h-4 w-4, h-5 w-5, h-6 w-6)
- [ ] Icon colors match design system (text-primary, text-muted-foreground)

## Data Management

### React Query
- [ ] All data fetching uses React Query hooks
- [ ] Query keys follow the established pattern
- [ ] Mutations invalidate related queries
- [ ] Loading and error states handled
- [ ] Optimistic updates implemented where appropriate

### Forms
- [ ] Forms use react-hook-form
- [ ] Validation uses Zod schemas
- [ ] Error messages display properly
- [ ] Form submission shows loading state
- [ ] Success/error feedback via toast notifications

### API Layer
- [ ] API functions in src/api/ directory
- [ ] Axios used for HTTP requests
- [ ] Proper error handling with try/catch
- [ ] Auth tokens handled by interceptors
- [ ] Type-safe API function signatures

## User Experience

### Notifications
- [ ] Sonner toasts used for all notifications
- [ ] Success actions show success toast
- [ ] Errors show descriptive error messages
- [ ] Loading states show toast.loading()

### Loading States
- [ ] Skeleton loaders shown during data fetch
- [ ] Buttons show loading state during submission
- [ ] Disabled state applied during async operations

### Error Handling
- [ ] Network errors caught and displayed
- [ ] User-friendly error messages (no stack traces)
- [ ] Fallback UI for error states
- [ ] No unhandled promise rejections

## Navigation

### Route Accessibility
- [ ] All pages have routes defined in router configuration
- [ ] Every page is accessible through navigation (menu, sidebar, or direct URL)
- [ ] Main pages (Dashboard, Home, Settings, etc.) accessible from primary navigation
- [ ] Secondary pages accessible through contextual navigation or direct links
- [ ] Deep-linked pages have breadcrumbs or back navigation
- [ ] 404/Not Found page implemented for invalid routes
- [ ] Protected routes have proper authentication checks
- [ ] Navigation state persists across page refreshes where appropriate

### Navigation UX
- [ ] Active route highlighted in navigation menu
- [ ] Clear visual hierarchy in navigation structure
- [ ] Mobile navigation is accessible and usable
- [ ] Navigation items have hover/focus states
- [ ] Nested routes show parent-child relationships
- [ ] User can always return to main areas (Dashboard/Home)

## Styling

### Tailwind CSS
- [ ] Tailwind v3 classes used
- [ ] HSL color variables from design system
- [ ] Custom CSS properties used where defined
- [ ] Responsive breakpoints: mobile-first approach
- [ ] Dark mode support via CSS variables

### Design System
- [ ] Colors use theme variables (primary, secondary, accent)
- [ ] Spacing uses Tailwind scale (p-4, gap-6, etc.)
- [ ] Border radius uses theme values (rounded-lg)
- [ ] Shadows use theme values (shadow-card)
- [ ] Typography follows Inter font system

## Accessibility

- [ ] Semantic HTML elements used
- [ ] Buttons have descriptive labels
- [ ] Forms have proper labels
- [ ] Focus states visible on interactive elements
- [ ] Color contrast meets WCAG standards

## Performance

- [ ] No console.log statements in production code
- [ ] No console errors in browser
- [ ] Images optimized (WebP, lazy loading)
- [ ] Large lists use virtualization if needed
- [ ] React Query cache configured appropriately

## Testing Readiness

- [ ] Components structured for easy testing
- [ ] Business logic separated from presentation
- [ ] Mock-friendly API layer
- [ ] No hardcoded values that should be configurable
- [ ] Environment variables properly configured

## Final Checks

- [ ] Code builds without errors (`npm run build`)
- [ ] Development server runs without errors (`npm run dev`)
- [ ] No TypeScript errors in editor
- [ ] Browser console is clean (no errors or warnings)
- [ ] All functionality works as expected
- [ ] Code follows existing project patterns
- [ ] Changes are consistent with the rest of the codebase



IMPORTANT: ALL styling and design decisions must follow the Design Reference section above EXACTLY. Do not make arbitrary design choices.

Analyze the existing project structure and implement the task following the patterns already established. Ensure all success criteria are met.